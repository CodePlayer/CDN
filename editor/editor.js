(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{289:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABLCAIAAAB7tddWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1Q0VBNzA0MjEyMDUxMUUzODk2Q0JFM0Q1RjE4QkExQyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1Q0VBNzA0MzEyMDUxMUUzODk2Q0JFM0Q1RjE4QkExQyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAzNDA2MkY1MTIwMzExRTM4OTZDQkUzRDVGMThCQTFDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAzNDA2MkY2MTIwMzExRTM4OTZDQkUzRDVGMThCQTFDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+K6izdgAAAvpJREFUeNrsnFmPqkAQhWmX667gEp9c/v+/MkSDG+4LrvdcSYgRbw/0ALZQ9WBUJOn+uqvqHGCG3e93hUJRUoSAQBAIAkEgCASBIBAE4neRicEcII51Xb/dbnjPGOt0OqlUKok7ApN3jIKwY6DUIBAEgkAQCALho/X47TeXy8U0TcuyrtdrZKPs9/v2m8FgINYgf9QX/gTV+Xw2DCNKBJKmxmKxsAVc0kEcDgfyGq8CNp/Pa5qWy+WiHG6v13v7/XPt6Ha7Al5D3HQ1Go1sNkvtU8lkMsmtESSoCASBSFqEW/DQ0tbr9W63O51OKK6FQkFV1XQ6nSwQ0OOTyQSvjknZbDaA0mq1QCQafSFFasxmM4eCE1Do0+lUQrcSFggsPhzq20NgsVqtkpIax+MxMs+C/aXruvMxaonND75J9W5hUWWxuYAVdRfTg8EplUphGJywQPAFuBd5Dlhw/aDwwgVtCDgCdzph1QisG+dosVjkn44WYxjGC4XnvBuNRtvt9gtA2Hv47SGsZKVS4ef8eDzG4vMVCrpSgEU3xPbZbDar1erLl1AQ7XabU8xAAXvB3XffBnIHwkR2QcUYq9fr5XIZOxkTg6BEkeNLKdQF7AWPFBy1AoUmu8RG/HmE91nxM+J/ORIr07VcLvf7feCt+stAQGIBRNJtOJolDAhdj/hXGj5+u+TzIKAF+MbkK00XFta2BhDRUE0/9gv8Elogbu4TBW8+nyPhHSeuaVqtVuNQC6TzyQUCXsg0TbfyAxfIKogr9ynP1GJyYQZ57qbg7AuIRfclKZwSlDqWBQSmxM9zFALYh+fFBwJJSkNgqeFxSrAPw+EQ9QJew7Is2Sj8FgSW2nu1gylYPkKRMsRTA+4IcjA2fxsnDkLOq/IfACFP54uP1yAQBIJAEIh4gWCPkHk+GJ7AjU/fICJ+qlIghEfoDwQMtRjvyLYDRih4rsDT+bBM9tP5kuhrzN++e6SqqvCdYUb/SIO6BoEgEASCQBAIAkEgCEQg8VeAAQAB1bbO2qoeewAAAABJRU5ErkJggg=="},293:function(e,t,a){e.exports=a(704)},614:function(e,t,a){},704:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(14),o=a(24),l=a(23),i=a(25),s=(a(294),a(0)),c=a.n(s),u=a(28),d=a.n(u),f=a(91),h=a(90),p=a(5),m=a(285),v=a.n(m),g=a(4),y=a(60),b=(a(614),a(2)),k={emptyData:Object(b.Map)(),schemaChildPath:["nodes","match"],listItemRules:{nodes:[{match:{type:"list-item"},min:1}]},getters:{get:function(e,t){return e.get(t)},attr:function(e,t){return e.getAttribute(t)},prop:function(e,t){return e[t]}},lastKeyDown:{},whiteSpaceRegex:/^\s*$/},w=window.Editor,N={isDebug:w&&w.debug||"#debug"===window.location.hash,getFileExt:function(e){var t=e.lastIndexOf(".");if(~t){var a=e.substr(t+1),n=a.indexOf("?");if(~n&&(a=a.substring(0,n)),~(n=a.indexOf("!"))&&(a=a.substring(0,n)),!~a.indexOf("/")&&!~a.indexOf("\\"))return a}return""},getFileName:function(e){var t=e.lastIndexOf("/");return~t?e.substr(t+1):e},isBlank:function(e){return null==e||""===e||k.whiteSpaceRegex.test(e)},findFirstMatch:function(e,t,a,n){void 0===n&&("string"===typeof t&&(t=t.split(".")),n=-1);var r=e[t[++n]],o=n===t.length-1;if(null==r)return null;if(!(r instanceof Array))return o?!a||a(r)?r:null:N.findFirstMatch(r,t,a,n);for(var l=0;l<r.length;l++){var i=r[l];return o?!a||a(i)?i:null:N.findFirstMatch(i,t,a,n)}},copyData:function(e,t,a,n){for(var r="string"===typeof a?k.getters[a]:a,o=0;o<n.length;o++){var l=n[o];"object"===typeof l&&(l=l.name);var i=r(e,l);null!=i&&(t[l]=i)}return t},clipNodeDef:function(e){if(e&&e.editor)return e.editor.$cfg.getByType(e.node.type)},clipClass:function(e,t,a){var n,r;e&&(a||(a=N.clipNodeDef(e)),n=N.clipNodeData(e).get("className"),null==t&&a&&(t=a.className),a&&a.selected&&(r=2===a.selected?e.isSelected:e.isSelected&&e.editor.value.selection.isCollapsed));if(n&&t&&null!=r){var o=n.split(" ");return N.mergeClass(o,t,!0),N.mergeClass(o,"selected",r),o.join(" ")}return t&&(n=N.mergeClass(n,t,!0)),null!=r&&(n=N.mergeClass(n,"selected",r)),n||null},isInElement:function(e,t){for(var a=e;a;){if(a.tagName===t)return!0;a=a.parentElement}return!1},findBlocks:function(e,t,a,n){n||1===a||(n=[]);var r=e.nodes;if(r)for(var o=0;o<r.size;o++){var l=r.get(o);if("block"===l.object){if(l.type===t){if(1===a)return l;if(n.push(l),n.length===a)return n}var i=N.findBlocks(l,t,a,n);if(1===a){if(i)return i}else if(a===n.length)return n}}return n},normalizePoint:function(e,t){return e.path?e:e.normalize(t)},isRangeWithRange:function(e,t,a,n){var r=g.j.compare,o=N.normalizePoint,l=n,i=e.start,s=e.end,c=a.start,u=a.end;switch(t){case"inside":return r(o(i,l).path,o(c,l).path)>=0&&r(o(s,l).path,o(u,l).path)<=0;case"cross":return i=o(i,l),c=o(c,l),r(i.path,c.path)>=0?r(i.path,o(u,l).path)<=0:r(o(s,l).path,c.path)>=0;case"outside":return i=o(i,l),c=o(c,l),r(i.path,c.path)>=0?r(o(u,l).path,i.path)<0:r(o(s,l).path,c.path)<0;default:throw new Error("Unexpected relationship:"+t)}},isNodeWithRange:function(e,t,a,n){var r=a.moveToRangeOfNode(e);return N.isRangeWithRange(r,t,a,n)},clipNodeData:function(e,t){return t&&t.data||e&&e.node.data||k.emptyData},hasClass:function(e,t){if(e&&t){var a=e.indexOf(t);if(-1!==a){if(e.length===t.length)return!0;if(0===a||" "===e.charAt(a-1)){var n=t.length+a;return n===e.length||" "===e.charAt(n)}}}return!1},eleHasClass:function(e,t){return!!(e&&e.className&&t)&&(e.classList.contains&&e.classList.contains(t)||N.hasClass(e.className,t))},clipDataAsAttrs:function(e,t,a,n){var r;if(a||(a=N.clipNodeDef(e)),a){if(a.attrs){r={};var o=N.clipNodeData(e,t);if(o&&o.size){r={};var l=!0,i=!1,s=void 0;try{for(var c,u=a.attrs[Symbol.iterator]();!(l=(c=u.next()).done);l=!0){var d=c.value;if(!d.data){var f=d.prop||d.name;if(null==d.match){var h=o.get(d.name);void 0!==h&&(r[f]=h)}else r[f]=d.match}}}catch(m){i=!0,s=m}finally{try{l||null==u.return||u.return()}finally{if(i)throw s}}}}if(!1!==n){var p=N.clipClass(e,null,a);p&&(r||(r={}),r.className=p)}}return r},mergeClass:function(e,t,a){if(!e)return a?t:null;if(!t)return e;var n=e instanceof Array,r=n?e:e.split(" "),o=r.indexOf(t);if(a&&-1===o)r.push(t);else{if(a||-1===o)return e;r.splice(o,1)}return n?r:r.join(" ")},noop:function(e){return e.preventDefault()},isEmptyNode:function(e){if(e.nodes.size<=1){var t=e.nodes.get(0);return null==t||"text"===t.object&&""===t.text}return!1},createNextChain:function(e,t,a){if(e&&e.length){var n=0;return function r(){n<e.length&&(0,e[n++])(t,a,r)}}},walkNodeTree:function(e,t,a){if(!(t>0))return a(e);t--;for(var n=e.nodes,r=0;r<n.size;r++)if(!1===N.walkNodeTree(n.get(r),t,a))return!1},pushImmutableList:function(e,t){if(t)for(var a=0;a<t.size;a++)e.push(t.get(a))},mergeNodeChildren:function(e,t){return null==t&&(t=e[0]),t.nodes.withMutations(function(a){for(var n=t===e[0]?1:0;n<e.length;n++)N.pushImmutableList(a,e[n].nodes)})},mergeBlockNodes:function(e,t,a,n,r){var o=e.value.document,l=t[0];null==a&&(a=o.getClosestBlock(l.key)),null==n&&(n=a.nodes.indexOf(l));var i=N.mergeNodeChildren(t,l),s=l.withMutations(function(e){return e=e.set("nodes",i),r&&(e=e.set("data",r)),e});e.withoutNormalizing(function(){for(var r=t.length-1;r>=0;r--){var l=t[r].key;o.hasNode(l)&&e.removeNodeByKey(l)}e.insertNodeByKey(a.key,n,s)})},getEventTransferWithCache:function(e){var t=e._cache;return t||(e._cache=t={}),t.timeStamp!==e.timeStamp&&(t.transfer=Object(y.e)(e),t.timeStamp=e.timeStamp),t.transfer},isDoubleKeyDown:function(e){var t=k.lastKeyDown,a=e.timeStamp;return a!==t.time&&(t.key=(e._dbkd=t.key===e.key&&t.time>a-300)?0:e.key,t.time=a),e._dbkd},previewImage:function(e,t){if("undefined"!==typeof URL&&URL.createObjectURL){var a=URL.createObjectURL(e);t&&t(a)}else{var n=new FileReader;n.addEventListener("load",function(e){return t&&t(e.target.result)}),n.readAsDataURL(e)}},unwrapPlugin:function(e,t){return"function"===typeof e?e(t):e},isTag:function(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t},minimizeHtml:function(e){return e?e.replace(/\s+<(?=h|p|f|t|d|im|bl|v|ul|ol|li|br|\/code><\/pre>)/g,"<"):e}};N.debug=N.isDebug?console.log:function(){var e=window.Editor;e&&e.debug&&(console.log.apply(this,arguments),N.debug=console.log)};var E=N,j=window.Prism,x="code-block",C="code-line",O=[{name:"Bash"},{name:"C"},{name:"C++",val:"cpp"},{name:"C#",val:"csharp"},{name:"CSS"},{name:"Go"},{name:"Groovy"},{name:"HTML & XML",val:"html"},{name:"Java"},{name:"JavaScript",val:"js"},{name:"JSON"},{name:"Kotlin"},{name:"Markdown"},{name:"Objective-C",val:"objectivec"},{name:"Perl"},{name:"PHP"},{name:"Properties"},{name:"Python"},{name:"Ruby"},{name:"Scala"},{name:"SQL"},{name:"Swift"},{name:"VB"},{name:"Vim"}];for(var z in O){var B=O[z];void 0===B.val&&(B.val=B.name.toLowerCase())}function S(e){return null==e&&(e=""),{object:"block",type:C,nodes:[{object:"text",text:e}]}}function A(e){var t=e.split("\n"),a=[];for(var n in t)a.push(S(t[n]));return a}var D=!0,T=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"onChangeData",value:function(e,t){var a=this.props,n=a.node,r=a.editor,o=n.data.set(t,this.refs[t].value=e.target.value);r.setNodeByKey(n.key,{data:o})}},{key:"render",value:function(){var e=this,t=this.props,a=t.editor,n=t.attributes,r=t.children,o=t.dataAttrs,l=o||{},i=l.filename,s=l.language,u=a?c.a.createElement("div",{className:"code-block-panel",contentEditable:!1},c.a.createElement("input",{ref:"filename",type:"text",placeholder:"\u8bf7\u8f93\u5165\u4ee3\u7801\u7247\u6bb5\u540d\u79f0...",defaultValue:i,onBlur:function(t){return e.onChangeData(t,"filename")}}),c.a.createElement("select",{ref:"language",defaultValue:s,onChange:function(t){return e.onChangeData(t,"language")}},c.a.createElement("option",{value:""},"==\u9009\u62e9\u8bed\u8a00=="),O.map(function(e,t){return c.a.createElement("option",{key:t,value:e.val},e.name)}))):null,d=x;return null==a&&s&&(d+=" language-"+s),c.a.createElement("pre",Object.assign({className:d},o,n),u,c.a.createElement("code",null,r))}}]),t}(c.a.Component);function I(e){return"string"===typeof e?e:"string"===typeof e.content?e.content:e.content.map(I).join("")}function M(e,t,a){return e[0]!==t&&(e[0]=t,e[1]=E.normalizePoint(e[1].moveToStartOfNode(t),a)),e[1]}var R={CodeBlock:T,plugin:function(e){var t={};return{_nodes:{"code-block":{tagName:"pre",object:"block",component:T,className:!1,langs:{zh:"\u4ee3\u7801\u5757"},attrs:[{name:"filename"},{name:"language",required:!0}],schema:{nodes:[{match:[{type:C}],min:1}]},deserialize:function(e,t,a){var n=e.childNodes[0],r=E.isTag(n,"code")?n:e,o=e.querySelector(".code-block-select select"),l=o?o.value:e.getAttribute("language");!l&&e.className&&/\blanguage-([a-z]+)\b/.test(e.className)&&(l=RegExp.$1);var i=e.getAttribute("filename"),s=A(r.textContent);return D=!1,D=!0,{object:"block",type:x,nodes:s,data:{filename:i,language:l}}}},"code-line":{tagName:"div",object:"block",text:"line",scope:"line",schema:{parent:{type:x},marks:[],nodes:[{match:[{object:"text"}]}]},deserialize:function(e,t,a){if(!D)return{object:"block",type:C,nodes:t(e.childNodes)}}}},renderMark:function(e,a,n){var r=e.children,o=e.mark,l=e.attributes;if(t[o.type]){var i="token "+o.type;return c.a.createElement("span",Object.assign({},l,{className:i}),r)}return n()},decorateNode:function(e,a,n){var r=n()||[];if(e.type!==x)return r;var o=e.data.get("language"),l=o?j.languages[o]:null;if(!l)return r;var i=e.getTexts().toArray(),s=i.map(function(e){return e.text}).join("\n"),c=j.tokenize(s,l),u=[],d=i.shift(),h=d,p=0,m=0,v=0,y=a.value.document,b=[null,g.k.create({})],k=!0,w=!1,N=void 0;try{for(var E,C=c[Symbol.iterator]();!(k=(E=C.next()).done);k=!0){var O=E.value;d=h,p=m;var z=I(O).length,B=v+z,S=d.text.length-p,A=z;for(m=p+A;S<A&&i.length>0;)h=i.shift(),A-=S+1,S=h.text.length,m=A;if("string"!=typeof O){var D=O.type,T={anchor:{key:d.key,path:M(b,d,y).path,offset:p},mark:{type:D}};T.focus={key:h.key,path:M(b,h,y).path,offset:m},u.push(T),t[D]||(t[D]=!0)}v=B}}catch(R){w=!0,N=R}finally{try{k||null==C.return||C.return()}finally{if(w)throw N}}return[].concat(Object(f.a)(r),u)},onKeyDown:function(e,t,a){return"Enter"!==e.key||E.isDoubleKeyDown(e)||t.value.startBlock.type!==C?a():(e.preventDefault(),t.insertBlock(S()))},onDropOrPaste:function(e,t,a){if(t.value.startBlock.type!==C)return a();var n=E.getEventTransferWithCache(e).text;if(n){var r={object:"value",document:{object:"document",nodes:A(n)}},o=g.o.fromJSON(r);t.insertFragment(o.document)}}}}},K=a(202),F=a(55),_=a(137),L=a.n(_),H=a(38),P=a.n(H),U=a(34),V=a.n(U),W=a(17),J=a.n(W),Q=a(290),G=a.n(Q),Z=a(289),$=a.n(Z),q=window.jQuery;var X=function(e,t,a){var n={type:"POST",url:e,dataType:"json",data:t,xhr:function(){var e=q.ajaxSettings.xhr();return e.upload&&a&&a.progress&&e.upload.addEventListener("progress",a.progress),e},processData:!1,contentType:!1,success:a&&a.success,error:a&&a.error};q.ajax(n)},Y="image",ee="image-block",te=["png","jpg","jpeg","bmp","gif","svg","webp"],ae=["src","width","height","alt"],ne=4;function re(e,t){if(e&&t){if(e<64&&t<32)return Y;if(e>=500||t>=100)return ee}}function oe(e,t,a){if(null==t&&(t={}),e.naturalWidth)t&&(t.width=e.naturalWidth,t.height=e.naturalHeight),a&&a(t);else if(e.width&&e.height)t&&e!==t&&(t.width=e.width,t.height=e.height),a&&a(t);else{var n=new Image;n.onload=function(){t.width=n.width,t.height=n.height,a&&a(t)},n.src=e.src}}function le(e){var t=le.pattern;return t||(le.pattern=t=/^(([a-z0-9-]+\.)*[a-z0-9-]+\.[a-z]{2,}(:\d{1,5})?)(\/|\b)/),!!t.test(e)&&RegExp.$1}function ie(e,t,a){var n=e.$cfg.maxUploadSize||ne;if(t.size>1024*n*1024){var r="\u56fe\u7247\u6587\u4ef6\u5927\u5c0f\u4e0d\u5f97\u8d85\u8fc7"+n+"MB\uff01";return a instanceof Function?a(r):(a=e.$app.StatusBarHook).setTips("error",r,15e3),!1}return!0}var se=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).listenLoad=function(e){if("load"===e.type){var t=a.holder.props,n=t.dataAttrs,r=t.editor,o=t.node;oe(e.target,Object(F.a)({},n),function(e){r.setNodeByKey(o.key,{data:e})})}},a.holder=e.father||Object(p.a)(Object(p.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.holder.props,t=e.editor.$cfg.opts;if(t&&t.uploadURL){var a,n=e.node,r=e.editor,o=n.data,l=o.get("file");if(l){if(!ie(r,l))return void r.removeNodeByKey(n.key);(a=new FormData).append(t.filename,l)}else if(t.urlName){var i=o.get("src"),s=function(e){if(!e)return null;if(e.startsWith("/"))return"";var t=e.indexOf("//");if(-1!==t){var a=e.indexOf("/",t+2);return e.substring(t+2,-1===a?e.length:a)}var n=le(e);return n||""}(i);s&&t.selfDomains&&function(e,t){for(var a=0;a<e.length;a++){var n=e[a];if(t.endsWith(n)&&(n.length===t.length||"."===t.charAt(t.length-n.length-1)))return!1}return!0}(t.selfDomains,s)&&(a=new FormData).append(t.urlName,i)}if(a){t.extraData&&t.extraData(a,r.$el);var c=r.$app.ImageProgressHook,u={progress:c.progress,success:function(e){if("OK"===e.status){c.success(e);var t=o.withMutations(function(t){return t.set("src",e.content.fileURI).delete("file")});r.setNodeByKey(n.key,{data:t})}else c.errorMsg("\u4e0a\u4f20\u5931\u8d25\uff1a\u9519\u8bef\u4fe1\u606f\u8be6\u89c1\u63a7\u5236\u53f0\u8f93\u51fa"),console.error(e.message),r.removeNodeByKey(n.key)},error:function(e,t,a){c.error(e,t,a),r.removeNodeByKey(n.key)}};X(t.uploadURL,a,u)}}}},{key:"render",value:function(){var e=this.holder.props,t=Object(F.a)({},e.dataAttrs);return this.props.father&&delete t.className,e.editor&&!t.width&&(t.onLoad=this.listenLoad),c.a.createElement("img",Object.assign({},this.props.attributes,{alt:t.alt},t))}}]),t}(c.a.Component),ce=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.node,a=e.attributes,n=t.data.get("width"),r=t.data.get("alt")||"\u8bf7\u5b8c\u5584\u56fe\u7247\u63cf\u8ff0",o=isNaN(n)?null:{width:Math.min(n,750)+"px"},l=E.clipClass(this.props);return c.a.createElement("figure",Object.assign({},a,{className:l,style:o}),c.a.createElement(se,{father:this}),c.a.createElement("figcaption",null,r))}}]),t}(c.a.Component),ue={image:function(e,t,a){t.target&&e.select(t.target),(a=a||t.type)!==ee?e.insertInline({type:Y,data:t}):e.insertBlock({type:ee,data:t})}},de=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).hide=function(){a.fileValue="",a.setState({show:!1,src:""})},a.show=function(e){a.callback=e,a.lastLoaded=null;var t=a.props.hook.data,n=Object(F.a)({},t,{show:!0,type:t.type,file:void 0,locked:re(t.width,t.height)});a.setState(n)},a.OK=function(){var e=a.refs,t=e.src,n=e.width,r=e.height;if(t.value!==a.lastLoaded)return alert("\u65e0\u6548\u7684\u56fe\u7247\u5730\u5740\uff01");if(isNaN(n.value)||n.value<=0||isNaN(r.value)||r.value<=0)return alert("\u65e0\u6548\u7684\u56fe\u7247\u5c3a\u5bf8\uff01");if(n.value>a.realSize.width||r.value>a.realSize.height)return alert("\u56fe\u7247\u5c3a\u5bf8\u8bbe\u7f6e\u4e0d\u5f97\u5927\u4e8e\u5b9e\u9645\u5c3a\u5bf8[ "+a.realSize.width+" * "+a.realSize.height+" ]\uff01 ");var o=Object(F.a)({},a.state);E.copyData(a.refs,o,function(e,t){return e[t].value},ae),a.fileValue&&(o.src=a.state.src),o.type=re(o)||a.state.type||ee,o.file||delete o.file,a.callback&&a.callback.call(Object(p.a)(Object(p.a)(a)),o),a.hide()},a.onInputSrc=function(e){var t=e.target.value;a.fileValue!==t&&(a.refs.file.value=a.fileValue="",le(t)&&(t="http://"+t),a.setState({src:t,file:null}))},a.onSizeChange=function(e,t,n){var r=a.refs,o=r.width,l=r.height;t&&(!n&&o.value||(o.value=t.width),!n&&l.value||(l.value=t.height));var i=re(o.value,l.value),s=i||a.state.type;i===a.state.locked&&s===a.state.type||a.setState({locked:i,type:s})},a.listenLoad=function(e){var t="load"===e.type;if(t){var n=null!=a.lastLoaded;a.lastLoaded=a.fileValue||a.refs.src.value,oe(e.target,a.realSize,function(t){return a.onSizeChange(e,t,n)})}a.refs.imageTips.style.display=t?"none":"inline"},a.onChangeDropdown=function(e){a.setState({type:e})},a.openFileDialog=function(e){a.refs.file.click()},a.handleSelectedFiles=function(e){var t=a.refs.file.files[0];if(t){var n=t.type.split("/");if("image"!==Object(K.a)(n,1)[0])return alert("\u4e0a\u4f20\u7684\u6587\u4ef6\u5fc5\u987b\u662f\u56fe\u7247\u7c7b\u578b\uff01");if(!ie(a.props.editor,t,alert))return;a.fileValue=a.refs.file.value,E.previewImage(t,function(e){return a.setState({src:e,file:t,alt:t.name})})}},a.resetSize=function(e){var t=a.refs,n=t.src,r=t.width,o=t.height;a.lastLoaded&&a.lastLoaded===n.value&&a.realSize.width?(r.value=a.realSize.width,o.value=a.realSize.height):alert("\u7531\u4e8e\u56fe\u7247\u5730\u5740\u8f93\u5165\u65e0\u6548\u6216\u56fe\u7247\u5c1a\u672a\u52a0\u8f7d\u5b8c\u6210\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={},a.realSize={},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=(e.locked||e.type||ee)!==Y?"\u72ec\u5360\u5f0f\uff08\u5927\u56fe\uff09":"\u5d4c\u5165\u5f0f\uff08\u5c0f\u56fe\uff09";return c.a.createElement(J.a,{show:this.state.show,backdrop:"static",keyboard:!1},c.a.createElement(J.a.Header,null,c.a.createElement(J.a.Title,null,"\u56fe\u7247")),c.a.createElement(J.a.Body,null,c.a.createElement("div",null,c.a.createElement("label",null,"\u56fe\u7247\u5730\u5740\uff1a"),c.a.createElement("input",{ref:"src",className:"form-control",type:"text",value:this.fileValue||e.src,onChange:this.onInputSrc,placeholder:"\u60a8\u4e5f\u53ef\u4ee5\u62d6\u62fd\u6216\u7c98\u8d34\u56fe\u7247\u5230\u7f16\u8f91\u5668\u4e2d\u76f4\u63a5\u4e0a\u4f20"})),c.a.createElement("div",null,c.a.createElement("label",null,"\u56fe\u7247\u63cf\u8ff0\uff1a"),c.a.createElement("input",{ref:"alt",className:"form-control",type:"text",defaultValue:e.alt,placeholder:"\u8bf7\u8f93\u5165\u56fe\u7247\u63cf\u8ff0\u4fe1\u606f"})),c.a.createElement("div",null,c.a.createElement("label",null,"\u56fe\u7247\u5c3a\u5bf8\uff1a")),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-xs-4"},c.a.createElement("div",{className:"form-group"},c.a.createElement("span",{className:"input-group"},c.a.createElement("span",{className:"input-group-addon"},"\u5bbd\u5ea6\uff1a"),c.a.createElement("input",{ref:"width",className:"form-control",type:"text",defaultValue:e.width,onChange:this.onSizeChange}),c.a.createElement("span",{className:"input-group-addon"},"px"))),c.a.createElement("div",{className:"form-group"},c.a.createElement("span",{className:"input-group"},c.a.createElement("span",{className:"input-group-addon"},"\u9ad8\u5ea6\uff1a"),c.a.createElement("input",{ref:"height",className:"form-control",type:"text",defaultValue:e.height,onChange:this.onSizeChange}),c.a.createElement("span",{className:"input-group-addon"},"px"))),c.a.createElement("div",null,c.a.createElement(G.a,{disabled:!!e.locked,onSelect:this.onChangeDropdown,value:Y,title:t,key:"image-dialog-splitter",id:"image-dialog-splitter"},c.a.createElement(V.a,{eventKey:ee},"\u72ec\u5360\u5f0f\uff08\u5927\u56fe\uff09"),c.a.createElement(V.a,{eventKey:Y},"\u5d4c\u5165\u5f0f\uff08\u5c0f\u56fe\uff09")),c.a.createElement("input",{ref:"file",type:"file",accept:"image/*",style:{opacity:0},onChange:this.handleSelectedFiles}))),c.a.createElement("div",{className:"col-xs-8 text-center image-preview",onClick:this.openFileDialog},c.a.createElement("div",null,e.src?c.a.createElement("img",{onLoad:this.listenLoad,onError:this.listenLoad,src:e.src,alt:"\u56fe\u7247\u9884\u89c8\uff0c\u70b9\u51fb\u53ef\u66ff\u6362\u56fe\u7247"}):c.a.createElement("img",{className:"img-picker",src:$.a,alt:"\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247"})),c.a.createElement("div",{className:"image-preview-tips"},"\u70b9\u51fb\u4e0a\u65b9\u56fe\u7247\u53ef\u4e0a\u4f20\u672c\u5730\u56fe\u7247")))),c.a.createElement(J.a.Footer,null,c.a.createElement("span",{className:"image-load-tips",ref:"imageTips"},"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5[\u56fe\u7247\u5730\u5740]\uff01"),c.a.createElement(P.a,{onClick:this.resetSize},"\u91cd\u7f6e\u5c3a\u5bf8\u4e3a\u539f\u59cb\u5927\u5c0f"),c.a.createElement(P.a,{onClick:this.hide},"\u5173\u95ed"),c.a.createElement(P.a,{bsStyle:"primary",onClick:this.OK},"\u4fdd\u5b58")))}}]),t}(c.a.Component),fe=function(e){function t(e){var a;return Object(n.a)(this,t),a=Object(o.a)(this,Object(l.a)(t).call(this,e)),e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={className:"success",tips:"\u62d6\u62fd\uff08\u63a8\u8350\uff09\u6216\u7c98\u8d34\u56fe\u7247\u5230\u7f16\u8f91\u5668\u53ef\u76f4\u63a5\u4e0a\u4f20"},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return this.state.tips?c.a.createElement("span",{key:this.props.self.name,className:this.state.className},this.state.tips):null}}]),t}(c.a.Component);var he={plugin:function(e){var t=[{name:"src",required:!0},{name:"alt"},{name:"width"},{name:"height"},{name:"file",data:!0}],a={isVoid:!0},n={image:{tagName:"img",component:se,selfClosing:!0,object:"inline",className:"image-inline",selected:!0,attrs:t,schema:a},"image-block":{tagName:"figure",component:ce,selfClosing:!0,object:"block",className:ee,selected:!0,langs:{zh:"\u56fe\u7247"},attrs:t,schema:a,deserialize:function(e,t,a){if(E.isTag(e,"figure")||e.classList&&e.classList.contains(ee)){var n=e.childNodes[0];if(E.isTag(n,"img")){var r=E.copyData(n,{},"attr",ae);return{object:"block",type:ee,data:r}}}},toolbarStatus:function(e,t){return this.getMatchActive(e,t)||this.getMatchActive(e===ee?Y:ee)},onClickToolbar:function(e,t,a){e.preventDefault();var n=this.editor,o=t.isActive,l=r.data,i=r.instance;l.type=o?o.type:null,E.copyData(o,l,function(e,t){return e?e.data.get(t):""},ae),i.show(function(e){o?o.type!==e.type?n.replaceNodeByNode(o,e.type,e):n.setNodeByKey(o.key,{data:e}).focus():n.command("image",e)})}}},r=e.ImageBlockDialogHook={data:{},type:de,instance:null,render:function(){return c.a.createElement(de,{hook:this.ImageBlockDialogHook,key:"image-block-dialog",editor:this.editor})}},o=e.StatusBarHook={instance:null,type:fe,setTips:function(e,t,a){var n=o.instance;n.setState({className:e,tips:t}),a>0&&setTimeout(function(){n.setState({tips:null})},a)}};return e.ImageProgressHook={progress:function(e){var t=[c.a.createElement(c.a.Fragment,null,"\u56fe\u7247\u6b63\u5728\u4e0a\u4f20\u2026\u2026")];if(e.lengthComputable){var a=Math.round(e.loaded/e.total*100);100===a&&e.loaded!==e.total&&(a=99),t.push(c.a.createElement("em",null,a,"%"))}o.setTips(null,t)},success:function(e){o.setTips("success","\u56fe\u7247\u4e0a\u4f20\u6210\u529f\uff01",5e3)},error:function(e,t,a){console.error(e,t,a),o.setTips("error","\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5["+e.status+"]\uff01",3e4)},errorMsg:function(e){o.setTips("error",e,3e4)}},{initConfig:function(e){e.statusBars.push({name:"editor-upload-tips",align:"right",render:function(e,t,a,n){return c.a.createElement(fe,{hook:o,key:a.name,props:e,editor:t,self:a})}})},_nodes:n,_component:r,commands:ue,onDropOrPaste:function(e,t,a){var n;if("drop"===e.type&&!(n=Object(y.d)(e,t)))return a();var r=E.getEventTransferWithCache(e),o=r.type,l=r.text,i=r.files;if("files"!==o){if("text"===o&&function(e){if(null==e)return!1;var t=e.lastIndexOf("?");~t&&(e=e.substring(0,t));var a=E.getFileExt(e);return a&&~te.indexOf(a.toLowerCase())}(l)&&L()(l)){var s=E.getFileName(l);return t.command("image",{src:l,alt:s,target:n})}a()}else{var c=!0,u=!1,d=void 0;try{for(var f,h=function(){var e=f.value,a=e.type.split("/");return"image"!==Object(K.a)(a,1)[0]?"continue":ie(t,e)?void E.previewImage(e,function(a){return t.command("image",{src:a,alt:e.name,target:n,file:e})}):"continue"},p=i[Symbol.iterator]();!(c=(f=p.next()).done);c=!0)h()}catch(m){u=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}}}},pe={link:function(e,t,a){null!=a&&(a||(a="\u8bf7\u8f93\u5165\u5185\u5bb9"),e.insertText(a).moveFocusBackward(a.length));var n=t.href.indexOf("//");-1!==n&&n<6&&(t.target="_blank"),e.wrapInline({type:"link",data:t}),e.moveToEnd().focus()},unlink:function(e){e.unwrapInline("link")}},me=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).hide=function(){a.setState({show:!1})},a.show=function(e){a.callback=e,a.setState({show:!0})},a.OK=function(){var e=a.refs.text,t=e.disabled?void 0:e.value,n=a.props.hook.data;n.href=a.refs.href.value,n.title=a.refs.title.value,n.target=a.refs.target.checked?"_blank":void 0,a.callback&&a.callback.call(Object(p.a)(Object(p.a)(a)),n,t),a.hide()},e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={show:!1},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.hook.data;return c.a.createElement(J.a,{show:this.state.show,backdrop:"static",keyboard:!1},c.a.createElement(J.a.Header,null,c.a.createElement(J.a.Title,null,"\u8d85\u94fe\u63a5")),c.a.createElement(J.a.Body,null,c.a.createElement("div",null,c.a.createElement("label",null,"\u951a\u6587\u672c\u5185\u5bb9\uff1a"),c.a.createElement("input",{ref:"text",className:"form-control",type:"text",disabled:null==e.text,defaultValue:null==e.text?"\u5f15\u7528\u9009\u4e2d\u76ee\u6807":e.text})),c.a.createElement("div",null,c.a.createElement("label",null,"\u94fe\u63a5\u5730\u5740\uff1a"),c.a.createElement("input",{ref:"href",className:"form-control",type:"text",defaultValue:e.href})),c.a.createElement("div",null,c.a.createElement("label",null,"\u94fe\u63a5\u6807\u9898\uff1a"),c.a.createElement("input",{ref:"title",className:"form-control",type:"text",defaultValue:e.title})),c.a.createElement("div",null,c.a.createElement("label",null,"\u662f\u5426\u5728\u65b0\u7a97\u53e3\u6253\u5f00\uff1a"),c.a.createElement("input",{ref:"target",type:"checkbox",defaultChecked:"_blank"===e.target,defaultValue:"1"}))),c.a.createElement(J.a.Footer,null,c.a.createElement(P.a,{onClick:this.hide},"\u5173\u95ed"),c.a.createElement(P.a,{bsStyle:"primary",onClick:this.OK},"\u4fdd\u5b58")))}}]),t}(c.a.Component);var ve={plugin:function(e){var t=e.LinkDialogHook={data:{},type:me,render:function(e,t){return c.a.createElement(me,{hook:this.LinkDialogHook,key:"link-dialog",editor:this.editor})}},a={tagName:"a",type:"link",object:"inline",attrs:[{name:"href",required:!0},{name:"target"},{name:"title"}],langs:{zh:"\u94fe\u63a5"},onClickToolbar:function(e,t,a){e.preventDefault();var n=this.editor,r=n.value,o=g.f.isInline(t.isActive)?t.isActive:null,l=r.selection.isExpanded,i=this.LinkDialogHook,s=i.data,c=i.instance;l?s.text=null:o&&o.nodes.some(function(e){return"text"!==e.object})?s.text=null:s.text=o?o.text:"",E.copyData(E.clipNodeData(null,o),s,function(e,t){return e.get(t)||""},["href","title","target"]),c.show(function(e,t){if(o){var a={data:e};void 0!==t&&t!==o.text?(a.nodes=[{object:"text",text:t}],a.type="link",a.object="inline",n.replaceNodeByKey(o.key,a)):n.setNodeByKey(o.key,a)}else n.command("link",e,t)})}};return{initConfig:function(e){e.registerToolbar({name:"unlink",langs:{zh:"\u53d6\u6d88\u94fe\u63a5"},command:"unlink",toolbarStatus:function(e){return g.f.isInline(a.isActive)?0:-1}})},_nodes:a,_component:t,commands:pe,onPaste:function(e,t,a){if(t.value.selection.isCollapsed)return a();var n=E.getEventTransferWithCache(e),r=n.type,o=n.text;return"text"!==r&&"html"!==r?a():L()(o)?(t.value.inlines.some(function(e){return"link"===e.type})&&t.command("unlink"),void t.command("link",{href:o})):a()}}}},ge=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n.a)(this,e),this.opts=t,this.defCache=[]}return Object(r.a)(e,[{key:"shortLang",value:function(e){if(e.length<4)return e;var t=e.indexOf("-");return-1===t&&(t=e.indexOf("_")),-1===t?e:e.substring(0,t)}},{key:"matchLangFromI18N",value:function(e,t,a){var n=this.opts[e];return n&&(a[0]&&(this.defCache[0]=this.langKey,this.defCache[1]=n,a[0]=!1),n[t])?n:null}},{key:"add",value:function(e,t,a){if(a){var n=this.opts;n[t]=n[t]||{},n[t][e]=a}else if("object"===typeof t)for(var r in t)this.add(e,r,t[r]);else if("object"===typeof e)for(var o in e)this.add(o,e[o])}},{key:"get",value:function(e,t){t||t||"object"!=typeof navigator||(t=navigator.languages||[navigator.language]);var a,n=[!0];if(this.langKey=t.join("|"),this.defCache[0]===this.langKey&&(a=this.defCache[1])[e])return a[e];for(var r={},o=0;o<t.length;o++){var l=t[o];if(null!=(a=this.matchLangFromI18N(l,e,n)))return a[e];var i=this.shortLang(l);if(!r[i]&&l!==i){if(null!=(a=this.matchLangFromI18N(i,e,n)))return a[e];for(var s in this.opts)if(l!==s&&i!==s&&i===this.shortLang(s)&&null!=(a=this.matchLangFromI18N(s,e,n)))return a[e];r[i]=!0}}return e}}]),e}(),ye=function e(t){var a=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(n.a)(this,e),this.normalize=function(e,t){if("function"===typeof e){var n=e;return function(e,t){if(!n(e,t))return this.normalize(e,t)}}var r=t.node,o=a.opts[r.type];o&&o(e,t)?console.warn("normalize hook not found:"+t.code,"".concat(r.type," [").concat(r.object,"]"),t):a.def(e,t)?console.log("normalized:"+t.code,"".concat(r.type," [").concat(r.object,"]")):console.warn("Unexpected normalize error:"+t.code,"".concat(r.type," [").concat(r.object,"]"),t)},this.defaultNormalize=function(e,t){var n=t.node,r=t.rule,o=a.cfg;switch(t.code){case"child_object_invalid":case"child_type_invalid":if("child_type_invalid"===t.code){var l=N.findFirstMatch(r,k.schemaChildPath,function(e){return e.type});if(l){if("text"===t.child.object){if(""!==t.child.text&&N.isBlank(t.child.text))return e.removeNodeByKey(t.child.key),!0;"block"===o.getByType(l.type).object?e.wrapBlockByKey(t.child.key,{type:l.type}):e.wrapInlineByKey(t.child.key,{type:l.type})}else e.setNodeByKey(t.child.key,{type:l.type});return!0}}else if(N.findFirstMatch(r,k.schemaChildPath,function(e){return e.object})){if("block"===t.child.object)e.unwrapBlock(t.child.type);else if("inline"===t.child.object)e.unwrapInline(t.child.type);else{var i=N.findFirstMatch(r,k.schemaChildPath,function(e){return e.type});e.setNodeByKey(t.child.key,{type:i?i.type:o.defNode})}return!0}break;case"child_min_invalid":var s=N.findFirstMatch(r,["nodes"],function(e){return e.min>t.count});if(s){var c=N.findFirstMatch(s,["match"],function(e){return e.type});if(c)return e.insertNodeByKey(n.key,t.index,{type:c.type,object:o.getByType(c.type).object}),!0}break;case"node_mark_invalid":return e.unwrapInline(t.mark.type),!0;case"parent_type_invalid":var u=N.findFirstMatch(r,["parent"],function(e){return e.type});if(u)return"block"!==t.parent.object?e.unwrapBlockByKey(t.node.key,{type:u.type}):e.setNodeByKey(t.parent.key,{type:u.type}),!0;break;case"last_child_type_invalid":case"first_child_type_invalid":var d="first_child_type_invalid"===t.code?"first":"last",f=N.findFirstMatch(r,[d],function(e){return e.type});if(f)return e.insertNodeByKey(n.key,"first"===d?0:n.nodes.size,{type:f.type,object:o.getByType(f.type).object}),!0}},this.cfg=t,this.opts=r,this.def=r.defaultNormalize||this.defaultNormalize},be=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n.a)(this,e),this.opts=t,this.defNode="paragraph";var a=this.defAttrs=t.defAttrs;this.tags={},this.toolbars={},this.statusBars=[],this.extraComponents=[],this.i18n=new ge(t.i18n),this.normalize=new ye(this,t.normalize),this.allowNodes={paragraph:{tagName:"p",object:"block",attrs:a,langs:{zh:"\u6bb5\u843d"}},"list-item":{tagName:"li",object:"block",attrs:a,schema:{parent:[{type:"numbered-list"},{type:"bulleted-list"}]}},"bulleted-list":{tagName:"ul",object:"block",attrs:a,langs:{zh:"\u65e0\u5e8f\u5217\u8868"},rule:k.listItemRules},"numbered-list":{tagName:"ol",object:"block",attrs:a,langs:{zh:"\u6709\u5e8f\u5217\u8868"},rule:k.listItemRules},"block-quote":{tagName:"blockquote",hotKey:["Ctrl","Q"],object:"block",attrs:a,langs:{zh:"\u5f15\u7528"}},title3:{tagName:"h3",object:"block",attrs:a,langs:{zh:"\u6807\u98983"}},title4:{tagName:"h4",object:"block",attrs:a,langs:{zh:"\u6807\u98984"}},title5:{tagName:"h5",object:"block",attrs:a,langs:{zh:"\u6807\u98985"}},title6:{tagName:"h6",object:"block",attrs:a,langs:{zh:"\u6807\u98986"}},text:{tagName:"span",className:"text",object:"block",text:!0,deserialize:function(e,t,a){if(N.eleHasClass(e,"text"))return{object:a.object,type:a.type,nodes:t(e.childNodes)}}},bold:{tagName:"strong",object:"mark",hotKey:["Ctrl","B"],langs:{zh:"\u52a0\u7c97"}},italic:{tagName:"em",object:"mark",hotKey:["Ctrl","I"],langs:{zh:"\u659c\u4f53"}},underlined:{tagName:"u",object:"mark",hotKey:["Ctrl","U"],langs:{zh:"\u4e0b\u5212\u7ebf"}},strikethrough:{tagName:"s",object:"mark",hotKey:["Ctrl","D"],langs:{zh:"\u5220\u9664\u7ebf"}},code:{tagName:"code",object:"inline",mark:1,hotKey:["Ctrl","`"],langs:{zh:"\u4ee3\u7801"}}},this.schema={document:{nodes:[{match:[]}],last:{type:this.defNode},normalize:this.normalize.normalize},blocks:{},inlines:{}};var r=t.compatNodes,o={block:{compat:!0,tagNames:r&&r.blockTags||["div","pre","hr","dl","dt","dd"],object:"block",attrs:a},inline:{compat:!0,tagNames:r&&r.inlineTags||["span","br"],object:"inline",attrs:a},mark:{compat:!0,tagNames:r&&r.markTags||["label","sup","sub","mark","small","cite","abbr","kbd","var","samp","q","data","ins","time"],object:"inline",mark:1,attrs:a}};for(var l in this.compatNodes={},o)for(var i=o[l],s=0;s<i.tagNames.length;s++){var c=i.tagNames[s],u=Object(F.a)({},i,{tagName:c});"hr"!==c&&"br"!==c||(u.selfClosing=!0,u.schema={isVoid:!0}),this.allowNodes[c]=u,this.compatNodes[c]=u}this.registerNode(this.allowNodes)}return Object(r.a)(e,[{key:"getByType",value:function(e,t){if(void 0===t||t===this.allowNodes)return this.allowNodes[e];for(var a in t)if(t[a].type===e)return t[a]}},{key:"registerNode",value:function(e,t){var a;if(t||e.object&&e.tagName){a=e;var n=this.tags[a.tagName];n||(this.tags[a.tagName]=n=[]),a.compat?n.push(a):n.unshift(a);var r,o=a.schema;o&&(o.normalize||!1===o.normalize||(o.normalize=this.normalize.normalize),this.schema["block"===a.object?"blocks":"inlines"][a.type]=o,o.parent&&(r=!1)),!1!==r&&!1!==a.docRoot&&"mark"!==a.object&&this.schema.document.nodes[0].match.push({type:a.type}),t||(this.allowNodes[a.type]=a),a.langs&&this.i18n.add(a.type,a.langs)}else for(var l in e)(a=e[l]).type||(a.type=l),e!==this.allowNodes&&(this.allowNodes[a.type]=a),this.registerNode(a,!0)}},{key:"registerToolbar",value:function(e){this.toolbars[e.name]=e,e.langs&&this.i18n.add(e.name,e.langs)}},{key:"getRule",value:function(e){var t=e.schema||e.rule;if(void 0===t){var a=this.schema["block"===e.type?"blocks":"inlines"][e.type];t=e.rule=a||null}return t}},{key:"getExpectedParents",value:function(e,t){if(e._||(e._={}),void 0===e._.parent){if(void 0===t&&!(t=this.getRule(e)))return e._.parent=null;var a=t.parent;e._.parent=a?a.length?a:[a]:null}return e._.parent}},{key:"getExpectedChildren",value:function(e,t){if(e._||(e._={}),void 0===e._.children){if(!t&&!(t=this.getRule(e)))return e._.children=null;var a=N.findFirstMatch(t,["nodes"],function(e){return e.match&&e.min});e._.children=a?a.match.length?a.match:[a.match]:null}return e._.children}},{key:"getRequiredChild",value:function(e,t){var a=this.getExpectedChildren(e,t);return a?a[0]:null}},{key:"isActiveForSpecialNode",value:function(e,t){var a=this,n=this.getExpectedChildren(e),r=!0;if(n&&n.length)for(var o=function(e){var o=n[e].type;if(o&&(r=t.nodes.some(function(e){return e.type===o&&a.isActiveForSpecialNode(a.getByType(o),e)})))return{v:!0}},l=0;l<n.length;l++){var i=o(l);if("object"===typeof i)return i.v}return r}},{key:"tooltip",value:function(e,t){var a=this.i18n.get(e);if(!t){var n=this.toolbars[e]||this.getByType(e);n&&n.hotKey&&(t=n.hotKey)}return t&&(a+=" ("+t.join("+")+")"),a}}]),e}(),ke={plugin:{commands:{replaceNodeByNode:function(e,t,a,n,r){var o=e.$cfg,l="object"===typeof a?a:o.getByType(a),i="block"===t.object,s="block"===l.object,c=e.value.document,u={type:l.type,object:l.object,data:n};if(r&&(u.nodes=r),i&&!s)c.getDepth(t.key)<2&&(u={type:o.defNode,object:"block",nodes:[u]});else if(!i&&s){var d=c.getParent(t.key);if(3!==d.nodes.size||d.type!==o.defNode||d.nodes.some(function(e){return e!==t&&!("text"===e.object&&""===e.text)}))return e.insertBlock(u).removeNodeByKey(t.key);t=d}e.replaceNodeByKey(t.key,u)}},renderNode:function(e,t,a){var n=e.children,r=e.node,o=t.$html.serialize(r,n,e,t,a);return o||a()},renderMark:function(e,t,a){var n=e.children,r=e.mark,o=t.$html.serialize(r,n,e,t,a);return null==o?a():o},onKeyDown:function(e,t,a){if(!t.$app.shortcutDetect(e)){var n=!1,r=E.isDoubleKeyDown(e);switch(e.key){case"Tab":n=!0;var o=t.value,l=o.startBlock,i=o.selection,s=e.shiftKey;if(i.isExpanded&&("code-line"===l.type||i.start.isAtStartOfNode(l)))t.withoutNormalizing(function(){for(var e=o.blocks.size,a=0;a<e;a++){var n=o.blocks.get(a);if(!t.isVoid(n)){var r=n.getFirstText();if(null!=r){var l=void 0;if(s){if(0===a){var c=i.moveToStart().moveStartBackward(1);if(c.start.isInNode(n))"\t"===o.document.getFragmentAtRange(c).text&&(l=c)}else{var u=n.getFirstText();u.text.length>0&&"\t"===u.text.charAt(0)&&(l=i.moveToStartOfNode(u).moveEndForward(1))}if(!l)return;t.deleteAtRange(l)}else t.insertTextByKey(r.key,0,"\t")}}}});else if(s){var c=i.moveToStart().moveStartBackward(1);if(c.start.isInNode(l))"\t"===o.document.getFragmentAtRange(c).text&&t.deleteAtRange(c)}else t.insertText("\t");break;case"Enter":if(e.shiftKey)return e.preventDefault(),t.insertText("\n");var u=t.value,d=u.document,f=u.endBlock,h=u.selection;if(r){if(h.end.isAtEndOfNode(f)){var p=d.getFurthestBlock(f.key);if(p){var m=d.getDepth(f.key),v=m>2;2===m&&(v=d.getParent(f.key).nodes.last()!==f),v?t.undo().splitBlock(2===m?2:m-1):t.undo().insertNodeByKey(d.key,d.nodes.indexOf(p)+1,{type:t.$cfg.defNode,object:"block"}).moveToEndOfNextBlock().focus(),n=!0}}}else if(h.isCollapsed&&h.end.isAtEndOfNode(f)){var g=t.$cfg.getByType(f.type);t.$cfg.getExpectedParents(g)||(n=!0,t.insertBlock(t.$cfg.defNode))}break;case"Backspace":var y=t.value,b=y.startBlock,k=y.selection,w=y.document;if(k.start.isAtStartOfNode(b)&&""===b.text){for(var N,j=w.getDepth(b.key),x=b;j-- >1&&!((N=w.getParent(x.key)).nodes.size>1);)x=N;x!==b&&(t.removeNodeByKey(x.key),n=!0)}}if(n)return e.preventDefault();a()}},onPaste:function(e,t,a){var n=E.getEventTransferWithCache(e),r=n.type;if("text"===r){if(n.text)return t.insertText(n.text)}else if("html"===r){var o=t.$html.decode(n.html).document;t.insertFragment(o)}else"fragment"===r?t.insertFragment(n.fragment):a()}}},we=a(291);function Ne(e){return"text"===e.object&&E.isBlank(e.text)}var Ee=function(){function e(t){var a=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(n.a)(this,e),this.cleanNode=function(e,t){t||(t=a.cfg.getByType(e.type)),t&&t.schema&&t.schema.isVoid&&(e.isVoid=!0);var n=e.nodes;if(!n||n.length<=1)return e;if("block"===(e.object||t.object)){for(var r,o,l,i=0;i<n.length;){var s=n[i];if(!(l=++i===n.length)&&1!==i||!Ne(s)){if("block"===s.object){if(r=!0,o)break}else if(o=!0,r)break}else{if(l?n.pop():n.shift(),1===n.length)return e;i=0}}if(!l)Ne(n[n.length-1])&&n.pop();if(r&&o)for(var c=0;c<n.length;c++){var u=n[c];"object"!==u.object&&(n[c]={type:"text",object:"block",nodes:[u]})}}return e},this.serialize=function(e,t,n,r,o){var l=a.cfg.getByType(e.type);if(l&&!1!==l.serialize){null==n&&(n={node:e}),n.children!==t&&(n.children=t),n.dataAttrs=E.clipDataAsAttrs(n,e,l,!0);var i=l.serialize?l.serialize(e,t,l,n,r,o):a.defaultSerialize(e,t,l,n,r,o);return E.isDebug&&E.debug("serialize:",e.toJS(),i),i}},this.deserialize=function(e,t){var n=e.tagName;if(n){n=a.getEquivalentTag(n.toLowerCase());var r=a.cfg.tags[n];if(r){for(var o,l=0;l<r.length;l++){var i=r[l];if(!1!==i.deserialize){if(i.deserialize){var s=i.deserialize(e,t,i);if(null==s)continue;return s=a.cleanNode(s,i),E.debug("deserialize:",e,s),s}null==o&&(o=i)}}if(o){var c=a.defaultDeserialize(e,t,o);return null!=c&&(c=a.cleanNode(c,o)),E.debug("deserialize:",e,c),c}console.warn("Unsupported element: ",e,r)}else console.warn("Unsupported element: ",e)}},this.defaultSerialize=function(e,t,a,n,r,o){if(null==r&&a.text){var l="line"===a.text?"\n":"";return c.a.createElement(c.a.Fragment,null,t,l)}if(a.component){var i=a.component;return c.a.createElement(i,n)}var s=a.tagName,u=n.attributes,d=n.dataAttrs;return a.selfClosing?c.a.createElement(s,Object.assign({},d,u)):c.a.createElement(s,Object.assign({},d,u),t)},this.defaultDeserialize=function(e,t,a){var n;if(a.attrs){n={};var r=!0,o=!1,l=void 0;try{for(var i,s=a.attrs[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value,u=c.prop?e[c.prop]:e.getAttribute(c.name);null!=u&&u!==c.defVal&&(n[c.name]=u)}}catch(f){o=!0,l=f}finally{try{r||null==s.return||s.return()}finally{if(o)throw l}}}if(!1!==a.className&&e.className){var d=E.mergeClass(e.className,"selected",!1);d&&(n||(n={}),n.className=d)}return{object:a.object,type:a.type,nodes:t(e.childNodes),data:n}},this.getEquivalentTag=function(e){var t=a.tagMapping[e];return t||e},this.cfg=t,this.opts=r,this.rules=r.htmlRules,this.tagMapping={del:"s",strike:"s",i:"em",h1:"h3",h2:"h4"}}return Object(r.a)(e,[{key:"getRules",value:function(){if(!this.rules){var e={serialize:this.serialize,deserialize:this.deserialize};this.rules=[e]}return this.rules}},{key:"getSerializer",value:function(){return this.serializer||(this.serializer=new we.a({rules:this.getRules(),defaultBlock:this.cfg.defNode})),this.serializer}},{key:"encode",value:function(e,t){var a=this.getSerializer().serialize(e);if(t){var n=document.createElement("div");n.textContent=a,a=n.innerHTML}return a}},{key:"decode",value:function(e){var t=this.getSerializer().deserialize(e);return E.isDebug&&E.debug("decode:",t.toJS()),t}}]),e}();function je(e,t,a,n){var r=e.value.document.getBlocks().reduce(function(e,t){return e+t.text.trim().length},0);return t.$el.charLength=r,c.a.createElement("span",{className:"input-counter",key:a.name,style:{minWidth:"100px"}},"\u5b57\u7b26\u7edf\u8ba1\uff1a",c.a.createElement("em",null,r))}function xe(e,t,a,n){var r=e.value,o=r.selection.start,l=r.document.getCommonAncestor(o.key,o.key);if(null==l)return null;var i=[],s=t.$cfg;do{if("text"===l.object){var u=l.marks;if(u&&u.size)for(var d=(u=u.toJS()).length-1;d>=0;d--)i.unshift(s.getByType(u[d].type).tagName)}else{if("document"===l.object){i.unshift("body");break}i.unshift(s.getByType(l.type).tagName)}l=r.document.getParent(l.key)}while(l);return c.a.createElement("span",{key:a.name},"\u5143\u7d20\u8def\u5f84\uff1a",i.join(" > ")," ")}var Ce={plugin:function(e){return{initConfig:function(e){var t=e.statusBars;t.push({name:"editor-word-counter",align:"right",index:-1,render:je}),t.push({name:"editor-path",index:0,render:xe})},renderEditor:function(e,t,a){var n=a(),r=t.$cfg,o=r.statusBars,l=r.orderedStatusBars;if(!l){var i=[];for(var s in o){var u=o[s],d=u.index,f=void 0;if(null!=d&&(f="function"===typeof d?d(o):d)<0&&(f=Math.max(o.length+f,0)),null!=f)null==i[f]?i[f]=u:i.splice(f,0,u);else{for(var h=!1,p=0;p<o.length;p++)if(null==i[p]){i[p]=u,h=!0;break}h||i.push(u)}}for(var m in l={left:[],right:[]},i){var v=i[m];"right"===v.align?l.right.push(v):l.left.push(v)}r.orderedStatusBars=l}return c.a.createElement(c.a.Fragment,null,n,c.a.createElement("div",{className:"editor-status-bar"},l.left.map(function(a,n){return a.render(e,t,a,n)}),c.a.createElement("span",{className:"status-bar-right"},l.right.map(function(a,n){return a.render(e,t,a,n)}))))}}}},Oe=a(197),ze=a.n(Oe),Be="table",Se="table-row",Ae="table-title",De="table-cell",Te=function(e){return e.type===De||e.type===Ae};function Ie(e,t){var a=!1!==(t&&t.thead),n=t&&t.rows||1,r=t&&t.cols||3;a&&n++;for(var o={type:Be,object:"block"},l={type:Se,object:"block"},i=a?{type:Ae,object:"block"}:void 0,s={type:De,object:"block"},c=[],u=a?[]:void 0,d=0;d<r;d++)c[d]=s,a&&(u[d]=i);for(var h=[],p=0;p<n;p++)h[p]=Object(F.a)({},l),h[p].nodes=a&&0===p?Object(f.a)(u):[].concat(c);return o.nodes=h,o}function Me(e){var t=e.cells,a=e.selectedCells,n=e.canMergeCells,r=e.affectedRows,o=e.affectedCols;if(void 0===n){if(n=a.length>1&&!(r.size>1&&r[0]&&a[0].node.type===Ae)){for(var l=a[0],i=a[a.length-1],s=l.rowIndex,c=l.colIndex,u=Math.max(s+l.rowspan-1,i.rowIndex+i.rowspan-1),d=Math.max(c+l.colspan-1,i.colIndex+i.colspan-1),f=0;!o[f];)f++;c>f&&(c=f);for(var h=s;h<=u;h++)for(var p=t[h],m=c;m<=d;m++){var v=p[m];if(!v.selected&&(!v.ref||!v.ref.selected))return e.canMergeCells=!1}}e.canMergeCells=n}return n}function Re(e,t){if(void 0===t&&(t=e.$app.getMatchActive(Be)),t){var a=[],n=[],r=[],o=[],l=[];o.size=0,l.size=0;for(var i=e.value,s=i.document,c=i.selection,u=t.nodes,d=0,f=0;f<u.size;f++,d++){var h=u.get(f),p=h.nodes;a[d]=h;for(var m=0,v=0;m<p.size;m++){var g=p.get(m),y=g.data.get("rowspan")||1,b=g.data.get("colspan")||1,k={node:g,rowspan:y,colspan:b},w=y>1||b>1?{ref:k}:null;E.isNodeWithRange(g,"cross",c,s)&&(k.selected=!0,r.push(k));for(var N=0;N<y;N++)for(var j=d+N,x=n[j]=n[j]||[],C=0;C<b;C++){for(;x[v];)v++;k.selected&&(o[j]||(o[j]=!0,o.size++),l[v]||(l[v]=!0,l.size++)),0===N&&0===C?(k.rowIndex=j,k.colIndex=v,x[v]=k):x[v]=w}}}return{table:t,rows:a,cells:n,selectedCells:r,affectedRows:o,affectedCols:l}}return null}function Ke(e,t,a){return e.withMutations(function(e){return e=t>1?e.set("rowspan",t):e.delete("rowspan"),a>1?e.set("colspan",a):e.delete("colspan")})}var Fe={table:function(e,t,a){if(!a){var n=Ie(0,t);return e.insertBlock(n)}if(a){var r=Re(e,a),o=r.rows,l=r.cells,i=l[0][0].node.type===Ae,s=l.length,c=l[0].length,u=t.thead,d=t.rows,f=t.cols;if(u&&d++,i===u&&s===d&&c===f)return;var h=[],p=Math.min(s,d),m=Math.max(s,d),v=Math.min(c,f),g=Math.max(c,f),y={type:De,object:"block"},b={type:Ae,object:"block"};e.withoutNormalizing(function(){if(i!==u)if(i){if(e.removeNodeByKey(o[0].key),c===f&&s===d+1)return}else{for(var t={type:Se,object:"block",nodes:[]},a=0;a<f;a++)t.nodes[a]=b;if(e.insertNodeByKey(o[0].key,0,t),c===f&&d===s+1)return}for(var n=c===f?p:i&&!u?1:0;n<m;n++)if(n>=d)e.removeNodeByKey(o[n].key);else{var k=n>=s;if(k||c!==f){for(var w=k?[]:l[n],N=0,E=k?0:v;E<g;E++)if(k)E<f&&(w[E]=y);else if(E>=c){if(E===c)for(var j=0;j<w.length;j++){w[j].node&&N++}e.insertNodeByKey(o[n].key,N++,y)}else if(E>=f){var x=w[E],C=x.ref;C?C.rowIndex<s&&C.colIndex<c&&-1===h.indexOf(C)&&(C.rowIndex+C.rowspan>d&&(C.rowspan=d-C.rowIndex),C.colIndex+C.colspan>f&&(C.colspan=f-C.colIndex),h.push(C)):e.removeNodeByKey(x.node.key)}k&&e.insertNodeByKey(r.table.key,n,{type:Se,object:"block",nodes:l})}}for(var O=0;O<h.length;O++){var z=h[O];e.setNodeByKey(z.node.key,{data:Ke(z.node.data,z.rowspan,z.colspan)})}})}else{var k=Ie(0,t);e.insertBlock(k)}},deleteTable:function(e,t){var a=t&&t.table||e.$app.getMatchActive(Be);a&&e.removeNodeByKey(a.key)},deleteRows:function(e,t){if(t||(t=Re(e))){var a=t,n=a.rows,r=a.affectedRows;if(r.length){if(r.size===n.length)return void e.removeNodeByKey(t.table.key);e.withoutNormalizing(function(){for(var t=0;t<r.length;t++)r[t]&&e.removeNodeByKey(n[t].key)})}}},deleteCols:function(e,t){if(t||(t=Re(e))){var a=t,n=a.affectedCols,r=a.cells;n.size!==r[0].length?e.withoutNormalizing(function(){for(var t=[],a=0;a<r.length;a++)for(var o=r[a],l=0;l<o.length;l++){var i=o[l];if(n[l]){if(i.ref&&(i=i.ref,!n[i.colIndex])){i.colspan--,-1===t.indexOf(i)&&t.push(i);continue}i.removed||(i.removed=!0,e.removeNodeByKey(i.node.key))}}for(var s=0;s<t.length;s++){var c=t[s],u=c.node.data;u=c.colspan>1?u.set("colspan",c.colspan):u.delete("colspan"),e.setNodeByKey(c.node,{data:u})}}):e.removeNodeByKey(t.table.key)}},mergeCells:function(e,t){if((t||(t=Re(e)))&&Me(t)){for(var a=t,n=a.rows,r=a.cells,o=a.selectedCells,l=a.affectedRows,i=a.affectedCols,s=o[0],c=n[s.rowIndex],u=s.node,d=l.size,f=i.size,h=o.map(function(e){return e.node}),p=E.mergeNodeChildren(h,u),m=0;!i[m];)m++;var v=d>1&&f===r[0].length?o[o.length-1].rowIndex:null,g=u.withMutations(function(e){return e.set("nodes",p).set("data",Ke(u.data,f===r[0].length?1:d,f))});e.withoutNormalizing(function(){for(var t=o.length-1;t>=0;t--){var a=o[t];null!=v&&a.rowIndex>s.rowIndex?a.rowIndex<=v&&(e.removeNodeByKey(n[v].key),v--):e.removeNodeByKey(a.node.key)}e.insertNodeByKey(c.key,m,g)})}},splitCell:function(e,t){if(t||(t=Re(e))){var a=t,n=a.selectedCells,r=a.rows,o=a.cells;if(1===n.length){var l=n[0];if(l.rowspan>1||l.colspan>1){var i=l.rowIndex,s=i+l.rowspan-1,c=l.colIndex,u=c+l.colspan-1,d={object:"block"};e.withoutNormalizing(function(){for(var t=i;t<=s;t++)for(var a=o[t],n=c;n<=u;n++){var l=a[n];t===i&&n===c?e.setNodeByKey(l.node.key,{data:Ke(l.node.data,0,0)}):(d.type||(d.type=l.ref.node.type),e.insertNodeByKey(r[t].key,n,d))}})}}}},toggleTitle:function(e,t){if(t||(t=Re(e))){var a=t,n=a.rows,r=a.selectedCells;if(a.affectedRows[0]){var o=r[0].node.type===Ae?De:Ae,l=n[0].nodes;e.withoutNormalizing(function(){for(var t=0;t<l.size;t++)e.setNodeByKey(l.get(t).key,o)})}}},insertRow:function(e,t,a){if(a||(a=Re(e))){var n,r=a,o=r.cells,l=r.selectedCells,i=r.affectedRows,s="after"!==t;if(s&&i[0]&&l[0].node.type===Ae)s=!1,n=0;else for(n=s?0:i.length-1;!i[n];)s?n++:n--;for(var c={type:De,object:"block"},u=o[n],d=o.length-1,f=[],h={type:Se,object:"block",nodes:[]},p=0;p<u.length;p++){var m=u[p],v=m.ref;v&&(s&&v.rowspan>1||!s&&n<d&&o[n+1][p].ref===v)?-1===f.indexOf(v)&&(v.rowspan++,f.push(v)):!s&&m.rowspan>1?-1===f.indexOf(m)&&(m.rowspan++,f.push(m)):h.nodes.push(c)}var g=s?n:n+1;e.withoutNormalizing(function(){e.insertNodeByKey(a.table.key,g,h);for(var t=0;t<f.length;t++){var n=f[t];e.setNodeByKey(n.node.key,{data:Ke(n.node.data,n.rowspan,n.colspan)})}})}},insertCol:function(e,t,a){if(a||(a=Re(e))){for(var n=a,r=n.rows,o=n.cells,l=n.affectedCols,i="after"!==t,s=i?0:l.length-1;!l[s];)i?s++:s--;for(var c={type:De,object:"block"},u=o[0].length-1,d=[],f=[],h=0;h<o.length;h++){var p=o[h],m=p[s],v=m.ref;if(v&&(i&&v.colspan>1||!i&&s<u&&p[s+1].ref===v))-1===d.indexOf(v)&&(v.colspan++,d.push(v));else if(!i&&m.colspan>1)-1===d.indexOf(m)&&(m.colspan++,d.push(m));else{for(var g=0,y=0;y<s;y++)p[y].node&&g++;!i&&p[s].node&&g++;var b=0===h&&p[0].node.type===Ae?{type:Ae,object:"block"}:c;f.push({parent:r[h],index:g,node:b})}}e.withoutNormalizing(function(){for(var t=0;t<d.length;t++){var a=d[t];e.setNodeByKey(a.node.key,{data:Ke(a.node.data,a.rowspan,a.colspan)})}for(var n=0;n<f.length;n++){var r=f[n];e.insertNodeByKey(r.parent.key,r.index,r.node)}})}}},_e=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).hide=function(){a.setState({show:!1})},a.show=function(e){a.callback=e;var t=a.props.hook.data,n=Object(F.a)({},t,{show:!0});a.setState(n)},a.OK=function(){var e=a.refs,t=e.thead,n=e.rows,r=e.cols;if(isNaN(n.value)||n.value<=0||isNaN(r.value)||r.value<=0)return alert("\u65e0\u6548\u7684\u56fe\u7247\u5c3a\u5bf8\uff01");if(n.value>200||r.value>200)return alert("\u8868\u683c\u7684\u884c\u6570\u548c\u5217\u6570\u5747\u4e0d\u5f97\u5927\u4e8e200\uff01");var o=a.props.hook.data;o.rows=n.value,o.cols=r.value,o.thead=t.checked,a.callback&&a.callback.call(Object(p.a)(Object(p.a)(a)),o),a.hide()},e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state;return c.a.createElement(J.a,{show:e.show,backdrop:"static",keyboard:!1,bsSize:"sm"},c.a.createElement(J.a.Header,null,c.a.createElement(J.a.Title,null,"\u8868\u683c\u5c5e\u6027")),c.a.createElement(J.a.Body,null,c.a.createElement("div",null,c.a.createElement("label",null,"\u6807\u9898\u884c\u8bbe\u7f6e\uff1a")),c.a.createElement("div",{className:"form-group"},c.a.createElement("input",{ref:"thead",type:"checkbox",defaultChecked:e.thead})," ",c.a.createElement("span",null,"\u6dfb\u52a0\u6807\u9898\u884c")),c.a.createElement("div",null,c.a.createElement("label",null,"\u5355\u5143\u683c\u8bbe\u7f6e\uff1a")),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"form-group col-xs-6"},c.a.createElement("span",{className:"input-group"},c.a.createElement("input",{ref:"rows",className:"form-control",type:"text",defaultValue:e.rows}),c.a.createElement("span",{className:"input-group-addon"},"\u884c"))),c.a.createElement("div",{className:"col-xs-6"},"\uff08\u4e0d\u542b\u6807\u9898\u884c\uff09")),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"form-group col-xs-6"},c.a.createElement("span",{className:"input-group"},c.a.createElement("input",{ref:"cols",className:"form-control",type:"text",defaultValue:e.cols}),c.a.createElement("span",{className:"input-group-addon"},"\u5217")))),c.a.createElement("div",null,"\u6ce8\u610f\uff1a\u8d85\u51fa\u539f\u8868\u683c\u7684\u90e8\u5206\u5185\u5bb9\u5c06\u4f1a\u88ab\u79fb\u9664\uff01")),c.a.createElement(J.a.Footer,null,c.a.createElement(P.a,{onClick:this.hide},"\u5173\u95ed"),c.a.createElement(P.a,{bsStyle:"primary",onClick:this.OK},"\u4fdd\u5b58")))}}]),t}(c.a.Component),Le=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).withMouseDown=function(e){if(2===e.button){var t=a.props.editor,n=t.$app,r=n.cfg.getByType("table"),o=r.isActive||n.getMatchActive(Be,r);if(o){e.preventDefault();var l=a.tableInfo=Re(t,o),i=a.activeMenu,s=l.selectedCells,c=l.affectedRows;i.mergeCells=Me(l),i.splitCell=1===s.length&&(s[0].rowspan>1||s[0].colspan>1),1===c.size&&c[0]?i.toggleTitle=s[0].node.type!==Ae:i.toggleTitle=null;var u=e.currentTarget.getBoundingClientRect(),d=e.clientX-u.left+10,f=e.clientY-u.top-36;return void a.setState({display:"block",left:d+"px",top:f+"px",zIndex:9999})}}"none"!==a.state.display&&(a.tableInfo=null,a.setState({display:"none"}))},a.onSelect=function(e){a.setState({display:"none"});var t,n=a.props.editor;switch(e){case"insertRowAfter":t="after";case"insertRowBefore":return n.command("insertRow",t,a.tableInfo);case"insertColAfter":t="after";case"insertColBefore":return n.command("insertCol",t,a.tableInfo);default:n.command(e,a.tableInfo)}},e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={display:"none"},a.activeMenu={},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.activeMenu||{},t=[];return t.push(c.a.createElement(V.a,{key:"deleteTable",eventKey:"deleteTable"},"\u5220\u9664\u8868\u683c")),null!=e.toggleTitle&&t.push(c.a.createElement(V.a,{key:"toggleTitle",eventKey:"toggleTitle"},"\u8f6c\u4e3a",e.toggleTitle?"\u6807\u9898\u884c":"\u666e\u901a\u884c")),t.push(c.a.createElement(V.a,{key:"deleteRows",eventKey:"deleteRows"},"\u5220\u9664\u9009\u4e2d\u884c")),t.push(c.a.createElement(V.a,{key:"deleteCols",eventKey:"deleteCols"},"\u5220\u9664\u9009\u4e2d\u5217")),e.mergeCells?t.push(c.a.createElement(V.a,{key:"mergeCells",eventKey:"mergeCells"},"\u5408\u5e76\u5355\u5143\u683c")):e.splitCell&&t.push(c.a.createElement(V.a,{key:"splitCell",eventKey:"splitCell"},"\u62c6\u5206\u5355\u5143\u683c")),t.push(c.a.createElement(V.a,{key:"insertRowBefore",eventKey:"insertRowBefore"},"\u4e0a\u65b9\u63d2\u5165\u4e00\u884c")),t.push(c.a.createElement(V.a,{key:"insertRowAfter",eventKey:"insertRowAfter"},"\u4e0b\u65b9\u63d2\u5165\u4e00\u884c")),t.push(c.a.createElement(V.a,{key:"insertColBefore",eventKey:"insertColBefore"},"\u5de6\u4fa7\u63d2\u5165\u4e00\u5217")),t.push(c.a.createElement(V.a,{key:"insertColAfter",eventKey:"insertColAfter"},"\u53f3\u4fa7\u63d2\u5165\u4e00\u5217")),c.a.createElement(ze.a,{style:this.state,title:"\u5220\u9664\u8868\u683c",key:"table-context-menu",id:"table-context-menu",onSelect:this.onSelect,rootCloseEvent:"mousedown"},t)}}]),t}(c.a.Component);var He={plugin:function(e){var t=e.TableDialogHook={data:{},type:_e,render:function(){return c.a.createElement(_e,{hook:this.TableDialogHook,key:"table-dialog",editor:this.editor})}},a=e.TableContextMenuHook={type:Le,render:function(){return c.a.createElement(Le,{hook:this.TableContextMenuHook,key:"table-context-menu",editor:this.editor})}},n={parent:{type:Se}},r=[{name:"rowspan",prop:"rowSpan",defVal:1},{name:"colspan",prop:"colSpan",defVal:1}],o={};return{_nodes:{table:{tagName:"table",object:"block",langs:{zh:"\u8868\u683c"},schema:{nodes:[{match:[{type:Se}],min:1}]},onClickToolbar:function(e,t,a){var n=this;e.preventDefault();var r=this.getMatchActive("table",t),o=this.TableDialogHook,l=o.data,i=o.instance;if(r){l.rows=r.nodes.size;var s=r.nodes.first();l.cols=s.nodes.reduce(function(e,t){return e+(t.data.get("colspan")||1)},0),l.thead=s.nodes.first().type===Ae,l.thead&&l.rows--}else l.rows=l.cols=3,l.thead=!0;i.show(function(e){return n.editor.command("table",e,r)})},serialize:function(e,t,a,n,r,o){var l=n.dataAttrs||{};return n.editor&&(l.onContextMenu=E.noop),c.a.createElement("table",Object.assign({},n.attributes,l),c.a.createElement("tbody",null,t))}},"table-row":{tagName:"tr",object:"block",schema:{parent:{type:Be},nodes:[{match:[{type:De},{type:Ae}],min:1}]}},"table-title":{tagName:"th",object:"block",selected:2,attrs:r,schema:n},"table-cell":{tagName:"td",object:"block",selected:2,attrs:r,schema:n}},commands:Fe,_component:[t,a],onMouseUp:function(e,t,n){a.instance.withMouseDown(e)},onSelect:function(e,t,a){var n=e.type;if("selectionchange"===n){var r=window.getSelection(),l=o.delayTask=function(){if(l===o.delayTask){if(void 0===o.firefox&&(o.firefox=navigator.userAgent.indexOf("Firefox")>0),o.firefox&&r.rangeCount&&"Caret"!==r.type){var e=o.anchor;if("selectionchange"===n){if(E.isInElement(r.anchorNode,"TR"))return void(e||(o.anchor=r))}else if(e&&"select"===n&&r.rangeCount>1){var i={anchorNode:e.anchorNode,anchorOffset:e.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset,isCollapsed:r.isCollapsed,rangeCount:r.rangeCount},s=Object(y.c)(i,t);if(s){E.isDebug&&E.debug("merged = ",s.toJS());var c=t.value.document.createSelection(s);return c=(c=c.setIsFocused(!0)).set("marks",t.value.selection.marks),t.select(c),void(o.anchor=null)}}o.anchor=null}a()}};setTimeout(o.delayTask,240)}else a()},onKeyDown:function(e,t,a){var n=e.key;switch(n){case"Backspace":case"Delete":case"Enter":var r=t.value,o=r.document,l=r.selection;if(l.isCollapsed&&"Enter"!==n){var i=o.getDescendant(l.start.key);if(Te(i))if("Backspace"===n){if(l.start.isAtStartOfNode(i)){var s=o.getPreviousText(i.key);if(!s||o.getClosest(s.key,Te))return e.preventDefault()}}else if(l.start.isAtEndOfNode(i)){var c=o.getNextText(i.key);if(!c||o.getClosest(c.key,Te))return e.preventDefault()}}var u=o.getClosest(l.start.key,Te),d=l.isCollapsed?u:o.getClosest(l.end.key,Te);if(u||d){var f=u===d;switch(e.key){case"Backspace":if(!f||l.isCollapsed&&l.start.isAtStartOfNode(u))return e.preventDefault();break;case"Delete":if(!f||l.isCollapsed&&l.start.isAtEndOfNode(d))return e.preventDefault();break;case"Enter":return e.preventDefault(),t.insertText("\n")}}}a()},onDropOrPaste:function(e,t,a){var n=t.value,r=n.document,o=n.selection,l=r.getClosest(o.start.key,Te);if(l){var i=E.getEventTransferWithCache(e),s=o.isCollapsed||r.getClosest(o.end.key,Te)===l;if("fragment"===i.type){for(var c,u,d=i.fragment,f=d;1===f.nodes.size&&"block"===f.nodes.get(0).object;)f=f.nodes.get(0);switch(f.type){case Be:null==c&&(c=2);case Se:null==c&&(c=1);case Ae:case De:var h=[];E.walkNodeTree(f,c,function(e){return h.push(e)});var p=E.mergeNodeChildren(h),m=g.a.fromJS({type:l.type,object:"block",nodes:p});u=d.set("nodes",b.List.of(m));break;default:u=d}return void(s?t.insertFragmentAtRange(o,u):t.insertFragment(u))}if(i.text)return void(s?t.insertTextAtRange(o,i.text):t.insertText(i.text))}a()}}}};function Pe(){var e=Pe._cache;return e||(Pe._cache=e={name:"fullscreen",langs:{zh:"\u5168\u5c4f\u663e\u793a"},toolbarStatus:function(e){return!!this.state.toolbar[e]},onClickToolbar:function(e,t,a){for(var n=t.name,r=e.target.parentElement;!r.classList.contains("editor-container");)r=r.parentElement;var o=r.querySelector(".cp-editor-body");o.style.height=this.state.toolbar[n]?"auto":window.innerHeight-o.previousElementSibling.offsetHeight-o.nextElementSibling.offsetHeight-10+"px",e.preventDefault(),this.setState({toolbar:Object(h.a)({},n,!this.state.toolbar[n])})}}),e}function Ue(){var e=Ue._cache;return e||(Ue._cache=e={name:"undo",hotKey:["Ctrl","Z"],langs:{zh:"\u64a4\u9500"},onClickToolbar:function(e,t,a){e.preventDefault(),this.editor.undo()},toolbarStatus:function(e){var t=this.state.value.data.get("undos");return t&&t.size?0:-1}}),e}function Ve(){var e=Ve._cache;return e||(Ve._cache=e={name:"redo",langs:{zh:"\u91cd\u505a"},onClickToolbar:function(e,t,a){e.preventDefault(),this.editor.redo()},toolbarStatus:function(e){var t=this.state.value.data.get("redos");return t&&t.size?0:-1}}),e}var We=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).hide=function(){a.setState({show:!1})},a.show=function(){a.setState({show:!0})},e.hook.instance=Object(p.a)(Object(p.a)(a)),a.state={show:!1},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(J.a,{className:"help-dialog",show:this.state.show,backdrop:"static",keyboard:!1,onHide:this.hide},c.a.createElement(J.a.Header,{closeButton:!0},c.a.createElement(J.a.Title,null,"\u7f16\u8f91\u5668\u4f7f\u7528\u5e2e\u52a9")),c.a.createElement(J.a.Body,null,c.a.createElement("h3",null,"\u5e38\u89c4"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5355\u51fb ",c.a.createElement("kbd",null,"Enter")," \u952e\u5c06\u53e6\u8d77\u65b0\u5efa\u4e00\u4e2a\u5757\u7ea7\u6807\u7b7e\uff08\u4e00\u822c\u4e3a\u6bb5\u843d(",c.a.createElement("code",null,"p"),")\uff0c\u89c6\u4e0a\u4e0b\u6587\u800c\u5b9a\uff09\u3002"),c.a.createElement("li",null,"\u5355\u51fb ",c.a.createElement("kbd",null,"Shift + Enter"),"\uff0c \u53ef\u5b9e\u73b0\u6807\u7b7e\uff08\u5982\uff1a\u6bb5\u843d\uff09\u5185\u6362\u884c\uff08\u76f8\u5f53\u4e8e",c.a.createElement("code",null,"<br>"),"\uff09\u3002"),c.a.createElement("li",null,"\u53cc\u51fb ",c.a.createElement("kbd",null,"Enter")," \u952e\u53ef\u8df3\u51fa\u5d4c\u5957\u7684\u6807\u7b7e\uff0c\u5e76\u53e6\u8d77\u65b0\u5efa\u4e00\u4e2a\u5757\u7ea7\u6807\u7b7e\u3002")),c.a.createElement("h3",null,"\u56fe\u7247"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u5c06\u672c\u5730\u56fe\u7247\u6587\u4ef6",c.a.createElement("em",null,"\u62d6\u62fd"),"\u6216",c.a.createElement("em",null,"\u7c98\u8d34"),"\u5230\u7f16\u8f91\u5668\u4e2d\uff0c\u53ef\u76f4\u63a5\u8fdb\u884c\u672c\u5730\u56fe\u7247\u4e0a\u4f20\u5e76\u9884\u89c8\u663e\u793a\u3002"),c.a.createElement("li",null,"\u5c06\u56fe\u7247\u5730\u5740\uff08",c.a.createElement("em",null,"\u7edd\u5bf9\u8def\u5f84"),"\uff09\u7c98\u8d34\u5230\u7f16\u8f91\u5668\u4e2d\uff0c\u53ef\u76f4\u63a5\u8fdb\u884c\u8fdc\u7a0b\u56fe\u7247\u4e0a\u4f20\u5e76\u9884\u89c8\u663e\u793a\u3002"),c.a.createElement("li",null,"\u4ec5\u652f\u6301",c.a.createElement("em",null,"png"),"\u3001",c.a.createElement("em",null,"jpg"),"\u3001",c.a.createElement("em",null,"jpeg"),"\u3001",c.a.createElement("em",null,"bmp"),"\u3001",c.a.createElement("em",null,"gif"),"\u7b49\u56fe\u7247\u683c\u5f0f\uff0c\u5355\u4e2a\u6587\u4ef6\u5927\u5c0f\u4e0d\u5f97\u8d85\u8fc7 ",c.a.createElement("em",null,"4MB"),"\u3002")),c.a.createElement("h3",null,"\u94fe\u63a5"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u590d\u5236\u4e00\u4e2a",c.a.createElement("em",null,"\u7edd\u5bf9\u8def\u5f84"),"\u7684\u7f51\u5740\uff0c\u9009\u4e2d\u7f16\u8f91\u5668\u4e2d\u7684\u4e00\u6bb5\u5185\u5bb9\uff0c\u7136\u540e\u7c98\u8d34\uff0c\u53ef\u5feb\u901f\u7ed9\u9009\u4e2d\u5185\u5bb9\u9644\u52a0\uff08\u6216\u66f4\u6362\uff09\u94fe\u63a5\u3002")),c.a.createElement("h3",null,"\u8868\u683c"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u5f53\u5149\u6807\u6216\u9009\u4e2d\u533a\u57df\u4f4d\u4e8e\u8868\u683c\u4e2d\u65f6\uff0c\u70b9\u51fb\u9f20\u6807\u53f3\u952e\u53ef\u663e\u793a\u76f8\u5e94\u7684\u5feb\u6377\u64cd\u4f5c\u83dc\u5355\uff08\u65b0\u589e\u3001\u5220\u9664\u3001\u5408\u5e76\u3001\u62c6\u5206\u7b49\uff09\u3002")),c.a.createElement("h3",null,"Markdown"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u76ee\u524d\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u4e3a\u6240\u89c1\u5373\u6240\u5f97\u6a21\u5f0f\uff0c\u6682\u4e0d\u652f\u6301Markdown\uff0c\u540e\u7eed\u5c06\u540c\u65f6\u652f\u6301Markdown\u8bed\u6cd5\uff08\u652f\u6301\u5b9e\u65f6\u9884\u89c8\uff09\u3002"),c.a.createElement("li",null,"\u672c\u7ad9\u6240\u6709\u975e\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u7684\u5185\u5bb9\u8f93\u5165\u6846\u5747\u652f\u6301Markdown\u8bed\u6cd5\uff0c\u540e\u7eed\u5c06\u5b8c\u5584\u5feb\u6377\u5de5\u5177\u680f\u3001\u5b9e\u65f6\u9884\u89c8\u7b49\u652f\u6301\u3002")),c.a.createElement("h3",null,"\u590d\u5236&\u62d6\u62fd&\u7c98\u8d34"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u7531\u4e8e\u4eceWord\u6587\u6863\u3001\u5176\u4ed6\u7f51\u9875\u7c98\u8d34\u7684\u5185\u5bb9\u542b\u6709\u5927\u91cf\u5197\u4f59\u7684",c.a.createElement("code",null,"style"),"\uff0c\u56e0\u6b64\u76ee\u524d\u4ec5\u652f\u6301\u7eaf\u6587\u672c\u7c98\u8d34\uff0c\u540e\u7eed\u5c06\u9010\u6e10\u589e\u5f3a\u5bf9\u5e38\u7528\u7b2c\u4e09\u65b9\u6587\u672c\u5de5\u5177\u548cHTML\u5185\u5bb9\u7684\u5904\u7406\u652f\u6301\u3002")),c.a.createElement("h3",null,"\u5373\u5c06\u5230\u6765"),c.a.createElement("ul",null,c.a.createElement("li",null,"@\u7528\u6237\u3001\u6a21\u677f\u3001\u5feb\u6377\u547d\u4ee4\u884c\u3001\u4f53\u9a8c\u4f18\u5316\u2026\u2026")),c.a.createElement("h3",null,"\u610f\u89c1\u53cd\u9988"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u5982\u679c\u60a8\u6709\u4efb\u4f55\u610f\u89c1\u6216\u5efa\u8bae\uff0c\u6b22\u8fce\u70b9\u51fb\u53f3\u4e0b\u89d2\u7684\u3010\u610f\u89c1\u53cd\u9988\u3011\u544a\u77e5\u6211\u4eec\uff0c\u6211\u4eec\u5c06\u5c3d\u53ef\u80fd\u7684\u503e\u542c\u5e76\u53ca\u65f6\u8ddf\u8fdb\u3002"))))}}]),t}(c.a.Component);function Je(e){var t=Je._cache;return t||(Je._cache=t={name:"help",hotKey:["Ctrl","H"],langs:{zh:"\u5e2e\u52a9"},onClickToolbar:function(t,a,n){t.preventDefault(),e.instance.show()},toolbarStatus:function(e){return 0}}),t}function Qe(){var e=Qe._cache;return e||(Qe._cache=e={name:"restore",langs:{zh:"\u6062\u590d\u4e0a\u6b21\u5173\u95ed\u9875\u9762\u65f6\u7684\u7f16\u8f91\u5185\u5bb9"},onClickToolbar:function(e,t,a){e.preventDefault();var n=this.localStorage("last");n&&this.setHtml(n)},toolbarStatus:function(e){return this.localStorage("last")?0:-1}}),e}var Ge,Ze={plugin:function(e){var t={type:We,render:function(e,a){return c.a.createElement(We,{hook:t,key:"help-dialog",container:this,editor:this.editor})}};return{initConfig:function(e){e.registerToolbar(Pe()),e.registerToolbar(Ue()),e.registerToolbar(Ve()),e.registerToolbar(Qe()),e.registerToolbar(Je(t))},_component:t}}};var $e=[{name:"chapter",options:["","paragraph","title3","title4","title5","title6"],defaultValue:"",tooltip:{zh:"\u6bb5\u843d&\u6807\u9898"}},["bold","format_bold"],["italic","format_italic"],["underlined","format_underlined"],["strikethrough","strikethrough_s"],["link","link"],["unlink","link_off"],["code","code"],["code-block","subject"],["block-quote","format_quote"],["numbered-list","format_list_numbered"],["bulleted-list","format_list_bulleted"],["image-block","image"],["table","grid_on"],["restore","restore"],["undo","undo"],["redo","redo"],["fullscreen","fullscreen",["F11"]],["help","help"]];function qe(e){return{renderEditor:function(t,a,n){var r=a.$el=e.props.forInput;return e.editor=a,r.$app=a.$app=e,a.$cfg=e.cfg,a.$html=e.htmlSerializer,n()}}}function Xe(e){var t=[qe(e),R.plugin,Ce.plugin,He.plugin,he.plugin,ve.plugin,Ze.plugin,ke.plugin];return function(e,t){var a=t.cfg,n=a.extraComponents;for(var r in e){var o=e[r]=E.unwrapPlugin(e[r],t);o._nodes&&a.registerNode(o._nodes);var l=o._component;if(l)if(l.length)for(var i=0;i<l.length;i++)n.push(l[i]);else n.push(l);o.initConfig&&o.initConfig(a),o.onDropOrPaste&&(o.onDrop=o.onPaste=o.onDropOrPaste),o.onMouseDown&&t.mouseDownHandlers.push(o.onMouseDown),o.onMouseUp&&t.mouseUpHandlers.push(o.onMouseUp)}}(t,e),e.opts.plugins&&(t=e.opts.plugins(t,e)),t}var Ye=function(e){function t(e,a){var r;Object(n.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e,a))).localStorage=function(e,t){var a=window.localStorage;if(a){var n=r.props.forInput,o=n&&n.name;if(o){var l=o+"$"+e;if(void 0===t)return a.getItem(l);if(!1===t)return a.removeItem(l);!0===t&&(t=r.getHtml()),t&&"<p></p>"!==t&&(E.debug("localStorage[",l,"] = ",t),a.setItem(l,t))}}},r.hasMark=function(e){return r.state.value.activeMarks.some(function(t){return t.type===e})},r.hasInline=function(e){return r.state.value.inlines.some(function(t){return t.type===e})},r.hasBlock=function(e){return r.state.value.blocks.some(function(t){return t.type===e})},r.setHtml=function(e){var t=r.htmlSerializer.decode(e);r.setState({value:t})},r.renderToolbarSelect=function(e,t,a){var n=t.name,o=t.options,l=t.defaultValue,i=t.tooltip;if(t._tooltipResolved||(i&&r.cfg.i18n.add(n,i),t._tooltipResolved=!0),null==a){for(var s=0;s<o.length;s++)if(""!==o[s]&&r.getMatchActive(o[s])){a=o[s];break}null==a&&(a=l)}var u=r.cfg.tooltip(n);return c.a.createElement("select",{key:e,onChange:function(e){return r.onChangeSelect(e,n)},"data-tip":u,value:a},o.map(function(e,t){return c.a.createElement("option",{key:t,value:e},""===e?u:r.cfg.tooltip(e))}))},r.onChangeSelect=function(e,t){var a=e.target.value;a&&r.onClickBlock(e,r.cfg.getByType(a))},r.renderToolbarButton=function(e,t,a,n){var o,l=r.cfg.toolbars[t],i="renderToolbar",s=!1;if(l){if(s=!0,l[i])return l[i].call(Object(p.a)(Object(p.a)(r)),t,a,n);l.toolbarStatus&&(o=l.toolbarStatus.call(Object(p.a)(Object(p.a)(r)),t))}var u=r.cfg.getByType(t);if(u){if(s=!0,u[i])return u[i].call(Object(p.a)(Object(p.a)(r)),t,a,n);if(u.toolbarStatus)o=u.toolbarStatus.call(Object(p.a)(Object(p.a)(r)),t,u);else switch(u.object){case"block":case"inline":o=r.getMatchActive(t,u);break;case"mark":o=r.hasMark(t)}}if(s)return!u||"block"!==u.object&&"inline"!==u.object||(u.isActive=o),c.a.createElement("span",{className:-1===o?"editor-toolbar-btn disabled":o?"editor-toolbar-btn active":"editor-toolbar-btn",key:e,onMouseDown:-1!==o?function(e){return r.onClickToolbar(e,t)}:void 0,"data-tip":r.cfg.tooltip(t,n)},c.a.createElement("span",{className:"material-icons editor-toolbar-icon"},a));console.warn("Unexpected toolbar = ",t)},r.onClickToolbar=function(e,t,a){var n=r.cfg.toolbars[t],o="onClickToolbar";if(n){if(n[o])return n[o].call(Object(p.a)(Object(p.a)(r)),e,n,a);if(n.command)return r.editor.command(n.command,a,e,n)}var l=r.cfg.getByType(t);if(l){if(l[o])return l[o].call(Object(p.a)(Object(p.a)(r)),e,l,a);switch(l.object){case"block":return r.onClickBlock(e,l,a);case"inline":e.preventDefault(),l.mark?r.onClickInlineMark(e,l,a):r.editor.insertInline({type:l.type,data:a}).moveToStartOfNextText().focus();break;case"mark":return r.onClickMark(e,l)}}n&&(e.preventDefault(),r.setState({toolbar:Object(h.a)({},t,!r.state.toolbar[t])}))},r.shortcutDetect=function(e){var t,a=[];switch(e.ctrlKey&&a.push("Ctrl"),e.shiftKey&&a.push("Shift"),e.altKey&&a.push("Alt"),e.which){case 122:t="F11";break;case 192:t="`";break;default:t=String.fromCharCode(e.which)}a.push(t);var n=r.shortcuts;if(!n){for(var o in n={},$e){var l=$e[o],i=void 0;if(l.length){i=l[2];var s=l[0];if(!i){var c=r.cfg.toolbars[s]||r.cfg.getByType(s);c&&c.hotKey&&(i=c.hotKey)}i&&(n[i.join("+")]=s)}}r.shortcuts=n,E.debug("\u5feb\u6377\u952e\u7ed1\u5b9a\uff1a",n)}var u=a.join("+");E.debug("\u5f53\u524d\u6309\u952e\uff1a",u);var d=n[u];if(d)return r.onClickToolbar(e,d),!0},r.onChange=function(e){var t=e.value,a=Object(p.a)(Object(p.a)(r));window.closeConfirm=!0,a.activeNode.target=void 0,a.activeNode.ancestors=void 0;var n=a.props.forInput,o=a.state.value;if(n){var l=window.Editor;l&&function(e){setTimeout(function(){l.errored||(n.__lastState=e)},3e3)}(o)}a.setState({value:t})},r.onMouseDown=function(e){var t=Object(p.a)(Object(p.a)(r)).editor;if("ff"===r.browser){var a=t.value,n=a.focusBlock;if(!a.selection.isFocused){var o=n?Object(y.b)(n):null;if(o){var l=window.getSelection();if(l&&l.focusNode!==o){var i=document.createRange();i.setStart(o,0),i.setEnd(o,0),l.removeAllRanges(),l.addRange(i)}}}}else if("gg"===r.browser){var s=t.value.document;if(1===s.nodes.size){var c=s.nodes.get(0);1===c.nodes.size&&c.type===r.cfg.defNode&&""===c.text&&t.insertText(" ")}}var u=E.createNextChain(r.mouseDownHandlers,e,t);u&&u()},r.onMouseUp=function(e){var t=E.createNextChain(r.mouseUpHandlers,e,r.editor);t&&t()},r.onClickMark=function(e,t){e.preventDefault(),r.editor.toggleMark(t.type)},r.onClickInlineMark=function(e,t){var a=t.type,n=t.isActive,o=Object(p.a)(Object(p.a)(r)).editor;n?o.unwrapInline(a):o.wrapInline(a)},r.onClickBlock=function(e,t){e.preventDefault();var a=t.type,n=t.isActive,o=Object(p.a)(Object(p.a)(r)).editor,l=r.cfg.getRule(t);if(l&&l.isVoid)n?o.setBlocks(r.cfg.defNode):o.insertBlock(a);else{var i=l?r.cfg.getRequiredChild(t,l):null;if(i&&n)o.withoutNormalizing(function(){return o.setBlocks(r.cfg.defNode).unwrapBlock(a)});else{for(var s=o.value,c={},u=0;u<s.blocks.size;u++){var d=s.blocks.get(u),f=r.cfg.getByType(d.type),h=r.cfg.getRule(f);if(h){var m=r.cfg.getExpectedParents(f,h);if(m)for(var v=0;v<m.length;v++){var g=m[v];c[g.type]=g}}}if(i){var y=r.cfg.getByType(i.type),b="line"===y.scope?{object:"block",type:a}:null;if(b){var k=s.selection.isExpanded?s.fragment.text.split("\n"):s.endBlock.text.split("\n");if(k.length>1){var w=[];for(var N in k)w.push({object:y.object,type:y.type,nodes:[{object:"text",text:k[N]}]});b.nodes=w}else b=null}o.withoutNormalizing(function(){if(b)o.insertBlock(b);else{for(var e in o.setBlocks(i.type),c)o.unwrapBlock(e);o.wrapBlock(a)}})}else o.withoutNormalizing(function(){for(var e in o.setBlocks(n?r.cfg.defNode:a),c)o.unwrapBlock(e)})}}};var i=Object(p.a)(Object(p.a)(r)),s=i.opts=e.options||{};i.cfg=new be(s),i.htmlSerializer=new Ee(i.cfg,s),i.mouseDownHandlers=[],i.mouseUpHandlers=[],i.plugins=Xe(i),i.activeNode={},i.placeholder=s.placeholder||e.forInput.getAttribute("placeholder")||"\u8bf7\u5728\u6b64\u8f93\u5165\u521b\u4f5c\u5185\u5bb9\uff01";var u=navigator.userAgent;i.browser=-1!==u.lastIndexOf("Chrome")?"gg":-1!==u.lastIndexOf("Firefox")?"ff":"--",Ge=function(e){return e&&!E.isDebug&&!1!==i.cfg.minimizeHtml&&(e=E.minimizeHtml(e)),e};var d=r.props.initVal||i.htmlSerializer.decode(Ge(e.forInput.value)||"<p></p>");return r.state={toolbar:{},value:d},r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"getMatchActive",value:function(e,t){t||(t=this.cfg.getByType(e));var a=this.getActiveNode(),n=a.target;if(null===n||n.type===e)return n;var r=this.state.value;if("inline"===t.object){if(r.selection.isExpanded){var o=r.inlines.filter(function(t){return t.type===e});if(0===o.size)return null;var l,i=r.selection,s=i.start,c=i.end,u=g.k.create({});return o.find(function(e){if(u=E.normalizePoint(u.moveToStartOfNode(e),r.document),g.j.compare(s.path,u.path)>=0){u=E.normalizePoint(u.moveToEndOfNode(e),r.document);var t=g.j.compare(c.path,u.path);if(t<0||0===t&&c.offset<=u.offset)return!0;if(0===c.offset){if(void 0===l){var a=r.document.getPreviousText(c.path);l=a?u.moveToEndOfNode(a):null}return u.equals(l)}}return!1})}if(t.schema&&t.schema.isVoid&&1===r.inlines.size){var d=r.inlines.get(0);if(d.type===t.type)return d}}var f=a.ancestors;if(void 0===f&&(f=r.document.getAncestors(n.key),a.ancestors=f||null),null!=f)for(var h=f.size-1;h>0;h--){var p=f.get(h);if(p.type===e&&this.cfg.isActiveForSpecialNode(t,p))return p}return null}},{key:"getHtml",value:function(e,t){return"boolean"===typeof e&&(t=e,e=null),null==e&&(e=this.state.value),this.htmlSerializer.encode(e,t)}},{key:"componentDidMount",value:function(){!function(e,t){t._synchronized=e;var a=t.constructor.prototype,n=Object.getOwnPropertyDescriptor(a,"value"),r=n.set,o=n.get;Object.defineProperty(a,"value",{get:function(){if(E.debug("call get textarea.value"),this._synchronized){var e=this._synchronized.getHtml();return"<p></p>"===e?"":e}return o.apply(this,arguments)},set:function(e){E.debug("call set textarea.value"),r.apply(this,arguments),Ge&&(e=Ge(e)),this._synchronized&&this._synchronized.setHtml(e)}})}(this,this.props.forInput);var e=window.editor=this.editor,t=this.cfg;t&&t.onLoad&&t.onLoad(e)}},{key:"componentWillUnmount",value:function(){var e=this.props.forInput,t=this.editor;e.$app=e.$editor=null,t.$app=t.$cfg=t.$html=null,window.editor=null}},{key:"getActiveNode",value:function(){if(void 0===this.activeNode.target){var e=this.state.value,t=e.selection,a=t.start,n=t.end,r=e.document.getCommonAncestor(a.key,n.key);if(r&&"text"===r.object&&a.isAtStartOfNode(r)){var o=e.document.getPreviousNode(r.key);o&&"block"!==o.object&&(r=o)}this.activeNode.target=r}return this.activeNode}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:this.state.toolbar.fullscreen?"editor-container fullscreen":"editor-container"},c.a.createElement("div",{className:"cp-editor-toolbar"},$e.map(function(t,a){return t.length?e.renderToolbarButton.apply(e,[a].concat(Object(f.a)(t))):e.renderToolbarSelect(a,t)})),c.a.createElement(y.a,{schema:this.cfg.schema,className:"cp-editor-body",autoFocus:!0,autoCorrect:!1,spellCheck:!1,placeholder:this.placeholder,plugins:this.plugins,value:this.state.value,onChange:this.onChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp}),c.a.createElement(v.a,{className:"custom-tooltip",place:"top"}),this.cfg.extraComponents.map(function(t,a){return t.render.call(e,t,a)}))}}]),t}(c.a.Component),et=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).restoreData=function(){var e=window.Editor;return e&&(e.errored=0),a.setState({hasError:-1}),!1},a.state={hasError:0},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidCatch",value:function(e,t){console.error("\u51fa\u9519\u5566\uff1a",e,t);var a=window.Editor;a&&(a.errored=1),this.setState({hasError:1})}},{key:"render",value:function(){var e=this.state.hasError;if(1===e)return c.a.createElement("p",{style:{color:"red"}},"\u62b1\u6b49!\u7f16\u8f91\u5668\u51fa\u4e86\u70b9\u610f\u5916\u3002\u8bf7\u653e\u5fc3\uff0c\u60a8\u7684\u8f93\u5165\u5185\u5bb9\u6211\u4eec\u5df2\u4e3a\u60a8\u59a5\u5584\u4fdd\u5b58\uff0c\u4f60\u53ef\u4ee5 ",c.a.createElement("a",{href:"# ",onClick:this.restoreData},"\u70b9\u51fb\u6b64\u5904")," \u5c1d\u8bd5\u6062\u590d\u5230\u6700\u540e\u4e00\u6b21\u6b63\u786e\u64cd\u4f5c\u7684\u7248\u672c\u3002");if(-1===e){var t=this.props,a=t.forInput.__lastState;return c.a.createElement(Ye,{forInput:t.forInput,options:t.options,autoFocus:!!t.autoFocus,initVal:a})}return this.props.children}}]),t}(c.a.Component);function tt(e,t){for(var a=document.querySelectorAll(e),n=!!document.addEventListener,r=0;r<a.length;r++){var o=a[r],l=o.getAttribute("init");if(!l||o.value)nt(o,t);else{var i=function(e){return function(a){e.__load||(e.__load=!0,nt(e,t,!0))}}(o);n?o.addEventListener(l,i):o.attachEvent("on"+l,i)}}}var at=window.Editor=[];function nt(e,t,a){t||(t={});var n=document.createElement("div"),r="cp-editor",o=t.className;o instanceof Function&&(o=o(e,t)),o&&(r=o+" "+r),n.className=r;var l=t.style;if(l instanceof Function&&(l=l(e,t)),e.style.display="none",l&&n.setAttribute("style",l),n.forInput=e,e.parentElement.insertBefore(n,e.nextSibling||e),d.a.render(c.a.createElement(et,{forInput:e,options:t,autoFocus:a},c.a.createElement(Ye,{forInput:e,options:t,autoFocus:!!a})),n),at.push(e),1===at.length){var i=window.jQuery;i?i(window).on("beforeunload",at.closeConfirmHandler):window.addEventListener?window.addEventListener("beforeunload",at.closeConfirmHandler):window.onbeforeunload=at.closeConfirmHandler}}at.closeConfirmHandler=function(){if(!1!==window.closeConfirm){for(var e=!1,t=at.closeCallback,a=0;a<at.length;a++){var n=at[a],r=n.value;if(r&&"<p></p>"!==r){e=!0;var o=n&&n.$app&&n.$app.editor,l=at.__closeCallback;l&&l(r,n,o),t&&t(r,n,o)}}if(e)return"\u60a8\u5f53\u524d\u7f16\u8f91\u7684\u5185\u5bb9\u5c1a\u672a\u63d0\u4ea4\uff0c\u60a8\u786e\u8ba4\u8981\u79bb\u5f00\u5417\uff1f"}},at.__closeCallback=function(e,t,a){var n=a&&a.$app;n&&n.localStorage("last",e)},at.init=tt,at.load=nt,at.get=function(e){var t=typeof e;return"number"===t?e=at[e]:"string"===t&&(e=document.querySelector(e)),e&&e.$app&&e.$app.editor||null},window.onEditorReady&&window.onEditorReady(tt)}},[[293,1,2]]]);
//# sourceMappingURL=main.60f9a4dd.chunk.js.map